"13-Dec-24 01:00:50" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 01:00:50" - root - INFO - main() is started
"13-Dec-24 01:00:50" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 01:00:54" - create_objects - INFO - Spark object is created
"13-Dec-24 01:00:57" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 01:00:57" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 01:00:57" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 10:19:47" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 10:19:47" - root - INFO - main() is started
"13-Dec-24 10:19:47" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 10:20:09" - create_objects - INFO - Spark object is created
"13-Dec-24 10:20:19" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 10:20:19" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 10:20:19" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 10:21:44" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 10:21:44" - root - INFO - main() is started
"13-Dec-24 10:21:44" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 10:21:55" - create_objects - INFO - Spark object is created
"13-Dec-24 10:21:55" - root - INFO - Object created
"13-Dec-24 10:21:59" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 10:21:59" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 10:21:59" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 10:42:42" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 10:42:42" - root - INFO - main() is started
"13-Dec-24 10:42:42" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 10:43:01" - create_objects - INFO - Spark object is created
"13-Dec-24 10:43:01" - root - INFO - Object created
"13-Dec-24 10:43:08" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 10:43:08" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 10:43:10" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 10:50:23" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 10:50:23" - root - INFO - main() is started
"13-Dec-24 10:50:23" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 10:50:37" - create_objects - INFO - Spark object is created
"13-Dec-24 10:50:37" - root - INFO - Object created
"13-Dec-24 10:50:42" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 10:50:42" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 10:50:42" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 10:50:43" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 10:50:43" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 11:03:38" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 11:03:38" - root - INFO - main() is started
"13-Dec-24 11:03:38" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 11:03:53" - create_objects - INFO - Spark object is created
"13-Dec-24 11:03:53" - root - INFO - Object created
"13-Dec-24 11:03:58" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 11:03:58" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 11:03:58" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 11:04:00" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 11:04:00" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 11:04:01" - validations - INFO - The dataframe count is 28338
"13-Dec-24 11:04:01" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 11:04:01" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"13-Dec-24 11:04:01" - validations - INFO - The dataframe top 10 records are 
"13-Dec-24 11:04:02" - validations - ERROR - Error in the method df_top10_recordsPandas >= 1.0.5 must be installed; however, it was not found.
"13-Dec-24 11:04:02" - root - ERROR - Error occurred in the main() method Pandas >= 1.0.5 must be installed; however, it was not found.
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/pandas/utils.py", line 27, in require_minimum_pandas_version
    import pandas
ModuleNotFoundError: No module named 'pandas'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 40, in main
    df_top10_rec(df_city,'df_city')
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/validations.py", line 36, in df_top10_rec
    df_pandas = df.limit(5).toPandas()
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/pandas/conversion.py", line 86, in toPandas
    require_minimum_pandas_version()
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/pandas/utils.py", line 34, in require_minimum_pandas_version
    raise ImportError(
ImportError: Pandas >= 1.0.5 must be installed; however, it was not found.
"13-Dec-24 11:36:52" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 11:36:52" - root - INFO - main() is started
"13-Dec-24 11:36:52" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 11:37:22" - create_objects - INFO - Spark object is created
"13-Dec-24 11:37:22" - root - INFO - Object created
"13-Dec-24 11:37:34" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 11:37:34" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 11:37:34" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 11:37:42" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 11:37:42" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 11:37:46" - validations - INFO - The dataframe count is 28338
"13-Dec-24 11:37:46" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 11:37:46" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"13-Dec-24 11:37:46" - validations - INFO - The dataframe top 10 records are 
"13-Dec-24 11:37:46" - validations - ERROR - Error in the method df_top10_recordsPandas >= 1.0.5 must be installed; however, it was not found.
"13-Dec-24 11:37:46" - root - ERROR - Error occurred in the main() method Pandas >= 1.0.5 must be installed; however, it was not found.
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/pandas/utils.py", line 27, in require_minimum_pandas_version
    import pandas
ModuleNotFoundError: No module named 'pandas'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 40, in main
    df_top10_rec(df_city,'df_city')
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/validations.py", line 36, in df_top10_rec
    df_pandas = df.limit(10).toPandas()
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/pandas/conversion.py", line 86, in toPandas
    require_minimum_pandas_version()
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/pandas/utils.py", line 34, in require_minimum_pandas_version
    raise ImportError(
ImportError: Pandas >= 1.0.5 must be installed; however, it was not found.
"13-Dec-24 11:44:22" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 11:44:22" - root - INFO - main() is started
"13-Dec-24 11:44:22" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 11:44:38" - create_objects - INFO - Spark object is created
"13-Dec-24 11:44:38" - root - INFO - Object created
"13-Dec-24 11:44:48" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 11:44:48" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 11:44:48" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 11:44:49" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 11:44:49" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 11:44:51" - validations - INFO - The dataframe count is 28338
"13-Dec-24 11:44:51" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 11:44:51" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 12:10:19" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 12:10:19" - root - INFO - main() is started
"13-Dec-24 12:10:19" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 12:10:38" - create_objects - INFO - Spark object is created
"13-Dec-24 12:10:38" - root - INFO - Object created
"13-Dec-24 12:10:43" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 12:10:43" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 12:10:43" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:10:44" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:10:44" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:10:47" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:10:47" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 12:10:48" - validations - INFO - The dataframe count is 28338
"13-Dec-24 12:10:48" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:10:48" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 12:10:48" - validations - INFO - The dataframe count is 105
"13-Dec-24 12:10:48" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:10:48" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 12:31:38" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 12:31:38" - root - INFO - main() is started
"13-Dec-24 12:31:38" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 12:31:58" - create_objects - INFO - Spark object is created
"13-Dec-24 12:31:58" - root - INFO - Object created
"13-Dec-24 12:32:06" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 12:32:06" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 12:32:06" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:32:07" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:32:07" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:32:11" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:32:11" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 12:32:12" - validations - INFO - The dataframe count is 28338
"13-Dec-24 12:32:12" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:32:12" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 12:32:12" - validations - INFO - The dataframe count is 105
"13-Dec-24 12:32:12" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:32:12" - root - ERROR - Error occurred in the main() method 'DataFrame' object has no attribute 'country_name'
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 63, in main
    df_city_sel = perform_data_clean(df_city)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_preprocessing.py", line 11, in perform_data_clean
    df_city_sel = df1.select(upper(df1.city).alias("city"), df1.state_id, upper(df1.state_name).alias("state_name"), upper(df1.country_name).alias("Country_name"), df1.population, df1.zips)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 3129, in __getattr__
    raise AttributeError(
AttributeError: 'DataFrame' object has no attribute 'country_name'
"13-Dec-24 12:33:24" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 12:33:24" - root - INFO - main() is started
"13-Dec-24 12:33:24" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 12:33:38" - create_objects - INFO - Spark object is created
"13-Dec-24 12:33:38" - root - INFO - Object created
"13-Dec-24 12:33:42" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 12:33:42" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 12:33:42" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:33:42" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:33:42" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:33:44" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:33:44" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 12:33:45" - validations - INFO - The dataframe count is 28338
"13-Dec-24 12:33:45" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:33:45" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 12:33:45" - validations - INFO - The dataframe count is 105
"13-Dec-24 12:33:45" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:33:45" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 12:35:41" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 12:35:41" - root - INFO - main() is started
"13-Dec-24 12:35:41" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 12:35:51" - create_objects - INFO - Spark object is created
"13-Dec-24 12:35:51" - root - INFO - Object created
"13-Dec-24 12:35:54" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 12:35:54" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 12:35:54" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:35:55" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:35:55" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:35:57" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:35:57" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 12:35:57" - validations - INFO - The dataframe count is 28338
"13-Dec-24 12:35:57" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:35:57" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 12:35:58" - validations - INFO - The dataframe count is 105
"13-Dec-24 12:35:58" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:35:58" - presc_run_data_preprocessing - INFO - perform_data_clean() is started
"13-Dec-24 12:35:58" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"13-Dec-24 12:35:58" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 12:51:33" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 12:51:33" - root - INFO - main() is started
"13-Dec-24 12:51:33" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 12:51:52" - create_objects - INFO - Spark object is created
"13-Dec-24 12:51:52" - root - INFO - Object created
"13-Dec-24 12:51:59" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 12:51:59" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 12:51:59" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:52:00" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:52:00" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:52:02" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:52:02" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 12:52:03" - validations - INFO - The dataframe count is 28338
"13-Dec-24 12:52:03" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:52:03" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 12:52:03" - validations - INFO - The dataframe count is 105
"13-Dec-24 12:52:03" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:52:03" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 12:52:03" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 12:52:03" - presc_run_data_preprocessing - ERROR - Error in the method spark_curr_date() 'DataFrame' object has no attribute 'speciality_description'
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_preprocessing.py", line 14, in perform_data_clean
    df_fact_sel = df2.select(df2.npi.alias("presc_id"), df2.nppes_provider_last_org_name.alias("presc_lname"), df2.nppes_provider_first_name.alias("presc_fname"), df2.nppes_provider_city.alias("presc_city"), df2.nppes_provider_state.alias("presc_state"), df2.speciality_description.alias("presc_spclt"),df2.years_of_exp, df2.drug_name, df2.total_claim_count.alias("trx_cnt"), df2.total_day_supply, df2.total_drug_cost)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 3129, in __getattr__
    raise AttributeError(
AttributeError: 'DataFrame' object has no attribute 'speciality_description'
"13-Dec-24 12:52:03" - root - ERROR - Error occurred in the main() method 'DataFrame' object has no attribute 'speciality_description'
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 62, in main
    df_city_sel, df_fact_sel = perform_data_clean(df_city, df_fact)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_preprocessing.py", line 14, in perform_data_clean
    df_fact_sel = df2.select(df2.npi.alias("presc_id"), df2.nppes_provider_last_org_name.alias("presc_lname"), df2.nppes_provider_first_name.alias("presc_fname"), df2.nppes_provider_city.alias("presc_city"), df2.nppes_provider_state.alias("presc_state"), df2.speciality_description.alias("presc_spclt"),df2.years_of_exp, df2.drug_name, df2.total_claim_count.alias("trx_cnt"), df2.total_day_supply, df2.total_drug_cost)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 3129, in __getattr__
    raise AttributeError(
AttributeError: 'DataFrame' object has no attribute 'speciality_description'
"13-Dec-24 12:52:58" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 12:52:58" - root - INFO - main() is started
"13-Dec-24 12:52:58" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 12:53:09" - create_objects - INFO - Spark object is created
"13-Dec-24 12:53:09" - root - INFO - Object created
"13-Dec-24 12:53:13" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 12:53:13" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 12:53:13" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:53:13" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:53:13" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 12:53:15" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 12:53:15" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 12:53:15" - validations - INFO - The dataframe count is 28338
"13-Dec-24 12:53:15" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:53:15" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 12:53:16" - validations - INFO - The dataframe count is 105
"13-Dec-24 12:53:16" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 12:53:16" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 12:53:16" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 12:53:16" - presc_run_data_preprocessing - ERROR - Error in the method spark_curr_date() 'DataFrame' object has no attribute 'years_of_exp'
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_preprocessing.py", line 14, in perform_data_clean
    df_fact_sel = df2.select(df2.npi.alias("presc_id"), df2.nppes_provider_last_org_name.alias("presc_lname"), df2.nppes_provider_first_name.alias("presc_fname"), df2.nppes_provider_city.alias("presc_city"), df2.nppes_provider_state.alias("presc_state"), df2.specialty_description.alias("presc_spclt"),df2.years_of_exp, df2.drug_name, df2.total_claim_count.alias("trx_cnt"), df2.total_day_supply, df2.total_drug_cost)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 3129, in __getattr__
    raise AttributeError(
AttributeError: 'DataFrame' object has no attribute 'years_of_exp'
"13-Dec-24 12:53:16" - root - ERROR - Error occurred in the main() method 'DataFrame' object has no attribute 'years_of_exp'
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 62, in main
    df_city_sel, df_fact_sel = perform_data_clean(df_city, df_fact)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_preprocessing.py", line 14, in perform_data_clean
    df_fact_sel = df2.select(df2.npi.alias("presc_id"), df2.nppes_provider_last_org_name.alias("presc_lname"), df2.nppes_provider_first_name.alias("presc_fname"), df2.nppes_provider_city.alias("presc_city"), df2.nppes_provider_state.alias("presc_state"), df2.specialty_description.alias("presc_spclt"),df2.years_of_exp, df2.drug_name, df2.total_claim_count.alias("trx_cnt"), df2.total_day_supply, df2.total_drug_cost)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 3129, in __getattr__
    raise AttributeError(
AttributeError: 'DataFrame' object has no attribute 'years_of_exp'
"13-Dec-24 14:29:51" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 14:29:51" - root - INFO - main() is started
"13-Dec-24 14:29:51" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 14:30:13" - create_objects - INFO - Spark object is created
"13-Dec-24 14:30:13" - root - INFO - Object created
"13-Dec-24 14:30:22" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 14:30:22" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 14:30:23" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 14:30:26" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 14:30:26" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 14:30:30" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 14:30:30" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 14:30:31" - validations - INFO - The dataframe count is 28338
"13-Dec-24 14:30:31" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 14:30:31" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 14:30:31" - validations - INFO - The dataframe count is 105
"13-Dec-24 14:30:31" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 14:30:31" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 14:30:31" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 14:30:31" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"13-Dec-24 14:30:31" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 14:48:59" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 14:48:59" - root - INFO - main() is started
"13-Dec-24 14:48:59" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 14:49:19" - create_objects - INFO - Spark object is created
"13-Dec-24 14:49:19" - root - INFO - Object created
"13-Dec-24 14:49:27" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 14:49:27" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 14:49:27" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 14:49:28" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 14:49:28" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 14:49:31" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 14:49:31" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 14:49:33" - validations - INFO - The dataframe count is 28338
"13-Dec-24 14:49:33" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 14:49:33" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 14:49:33" - validations - INFO - The dataframe count is 105
"13-Dec-24 14:49:33" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 14:49:33" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 14:49:33" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 14:49:33" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"13-Dec-24 14:49:33" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"13-Dec-24 14:49:33" - validations - INFO - The dataframe df_fact_sel schema is 
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('presc_lname', StringType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('presc_fname', StringType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('presc_city', StringType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('presc_state', StringType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('year_exp', StringType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('drug_name', StringType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"13-Dec-24 14:49:33" - validations - INFO - 	StructField('country_name', StringType(), False)
"13-Dec-24 14:49:33" - validations - INFO - The Dataframe schema validation is completed
"13-Dec-24 14:49:33" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 16:10:15" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 16:10:15" - root - INFO - main() is started
"13-Dec-24 16:10:15" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 16:10:37" - create_objects - INFO - Spark object is created
"13-Dec-24 16:10:37" - root - INFO - Object created
"13-Dec-24 16:10:48" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 16:10:48" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 16:10:48" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:10:51" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:10:51" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:10:57" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:10:57" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 16:10:59" - validations - INFO - The dataframe count is 28338
"13-Dec-24 16:10:59" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:10:59" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 16:11:01" - validations - INFO - The dataframe count is 105
"13-Dec-24 16:11:01" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:11:01" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 16:11:04" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 16:11:04" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"13-Dec-24 16:11:04" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"13-Dec-24 16:11:04" - validations - INFO - The dataframe df_fact_sel schema is 
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('presc_lname', StringType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('presc_fname', StringType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('presc_city', StringType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('presc_state', StringType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('drug_name', StringType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"13-Dec-24 16:11:04" - validations - INFO - 	StructField('country_name', StringType(), False)
"13-Dec-24 16:11:04" - validations - INFO - The Dataframe schema validation is completed
"13-Dec-24 16:11:04" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 16:14:49" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 16:14:49" - root - INFO - main() is started
"13-Dec-24 16:14:49" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 16:15:14" - create_objects - INFO - Spark object is created
"13-Dec-24 16:15:14" - root - INFO - Object created
"13-Dec-24 16:15:21" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 16:15:21" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 16:15:21" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:15:22" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:15:22" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:15:26" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:15:26" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 16:15:28" - validations - INFO - The dataframe count is 28338
"13-Dec-24 16:15:28" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:15:28" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 16:15:28" - validations - INFO - The dataframe count is 105
"13-Dec-24 16:15:28" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:15:28" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 16:15:28" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 16:15:28" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"13-Dec-24 16:15:28" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"13-Dec-24 16:15:28" - validations - INFO - The dataframe df_fact_sel schema is 
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('presc_city', StringType(), True)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('presc_state', StringType(), True)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('drug_name', StringType(), True)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('country_name', StringType(), False)
"13-Dec-24 16:15:28" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"13-Dec-24 16:15:28" - validations - INFO - The Dataframe schema validation is completed
"13-Dec-24 16:15:28" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 16:26:36" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 16:26:36" - root - INFO - main() is started
"13-Dec-24 16:26:36" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 16:26:53" - create_objects - INFO - Spark object is created
"13-Dec-24 16:26:53" - root - INFO - Object created
"13-Dec-24 16:26:58" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 16:26:58" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 16:26:58" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:26:59" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:26:59" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:27:02" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:27:02" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 16:27:02" - validations - INFO - The dataframe count is 28338
"13-Dec-24 16:27:02" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:27:02" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 16:27:03" - validations - INFO - The dataframe count is 105
"13-Dec-24 16:27:03" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:27:03" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 16:27:03" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 16:27:04" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"13-Dec-24 16:27:04" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"13-Dec-24 16:27:04" - validations - INFO - The dataframe df_fact_sel schema is 
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('presc_city', StringType(), True)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('presc_state', StringType(), True)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('drug_name', StringType(), True)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('country_name', StringType(), False)
"13-Dec-24 16:27:04" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"13-Dec-24 16:27:04" - validations - INFO - The Dataframe schema validation is completed
"13-Dec-24 16:27:04" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 16:36:34" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 16:36:34" - root - INFO - main() is started
"13-Dec-24 16:36:34" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 16:36:52" - create_objects - INFO - Spark object is created
"13-Dec-24 16:36:52" - root - INFO - Object created
"13-Dec-24 16:36:59" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 16:36:59" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 16:36:59" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:37:00" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:37:00" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:37:03" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:37:03" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 16:37:04" - validations - INFO - The dataframe count is 28338
"13-Dec-24 16:37:04" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:37:04" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 16:37:05" - validations - INFO - The dataframe count is 105
"13-Dec-24 16:37:05" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:37:05" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 16:37:05" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 16:37:05" - presc_run_data_preprocessing - ERROR - Error in the method spark_curr_date() 'function' object has no attribute 'partitionBy'
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_preprocessing.py", line 31, in perform_data_clean
    spec = window.partitionBy("presc_id")
AttributeError: 'function' object has no attribute 'partitionBy'
"13-Dec-24 16:37:05" - root - ERROR - Error occurred in the main() method 'function' object has no attribute 'partitionBy'
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 62, in main
    df_city_sel, df_fact_sel = perform_data_clean(df_city, df_fact)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_preprocessing.py", line 31, in perform_data_clean
    spec = window.partitionBy("presc_id")
AttributeError: 'function' object has no attribute 'partitionBy'
"13-Dec-24 16:38:26" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 16:38:26" - root - INFO - main() is started
"13-Dec-24 16:38:26" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 16:38:38" - create_objects - INFO - Spark object is created
"13-Dec-24 16:38:38" - root - INFO - Object created
"13-Dec-24 16:38:41" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 16:38:41" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 16:38:41" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:38:42" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:38:42" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:38:44" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:38:44" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 16:38:47" - validations - INFO - The dataframe count is 28338
"13-Dec-24 16:38:47" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:38:47" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 16:38:48" - validations - INFO - The dataframe count is 105
"13-Dec-24 16:38:48" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:38:48" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 16:38:48" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 16:38:48" - presc_run_data_preprocessing - ERROR - Error in the method spark_curr_date() type Column doesn't define __round__ method
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_preprocessing.py", line 34, in perform_data_clean
    df_fact_sel = df_fact_sel.withColumn('trx_cnt',coalesce("trx_cnt", round(avg("trx_cnt").over(spec))))
TypeError: type Column doesn't define __round__ method
"13-Dec-24 16:38:48" - root - ERROR - Error occurred in the main() method type Column doesn't define __round__ method
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 62, in main
    df_city_sel, df_fact_sel = perform_data_clean(df_city, df_fact)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_preprocessing.py", line 34, in perform_data_clean
    df_fact_sel = df_fact_sel.withColumn('trx_cnt',coalesce("trx_cnt", round(avg("trx_cnt").over(spec))))
TypeError: type Column doesn't define __round__ method
"13-Dec-24 16:40:29" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 16:40:29" - root - INFO - main() is started
"13-Dec-24 16:40:29" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 16:40:44" - create_objects - INFO - Spark object is created
"13-Dec-24 16:40:44" - root - INFO - Object created
"13-Dec-24 16:40:49" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 16:40:49" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 16:40:49" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:40:49" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:40:49" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 16:40:51" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 16:40:51" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 16:40:52" - validations - INFO - The dataframe count is 28338
"13-Dec-24 16:40:52" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:40:52" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 16:40:52" - validations - INFO - The dataframe count is 105
"13-Dec-24 16:40:52" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 16:40:52" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 16:40:52" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 16:40:54" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"13-Dec-24 16:40:54" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"13-Dec-24 16:40:54" - validations - INFO - The dataframe df_fact_sel schema is 
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('presc_city', StringType(), True)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('presc_state', StringType(), True)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('drug_name', StringType(), True)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('country_name', StringType(), False)
"13-Dec-24 16:40:54" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"13-Dec-24 16:40:54" - validations - INFO - The Dataframe schema validation is completed
"13-Dec-24 16:40:54" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 17:02:17" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 17:02:17" - root - INFO - main() is started
"13-Dec-24 17:02:17" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 17:02:38" - create_objects - INFO - Spark object is created
"13-Dec-24 17:02:38" - root - INFO - Object created
"13-Dec-24 17:02:44" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 17:02:44" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 17:02:44" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 17:02:45" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 17:02:45" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 17:02:52" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 17:02:52" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 17:02:53" - validations - INFO - The dataframe count is 28338
"13-Dec-24 17:02:53" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 17:02:53" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 17:02:53" - validations - INFO - The dataframe count is 105
"13-Dec-24 17:02:53" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 17:02:53" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 17:02:53" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 17:02:54" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"13-Dec-24 17:02:54" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"13-Dec-24 17:02:54" - validations - INFO - The dataframe df_fact_sel schema is 
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('presc_city', StringType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('presc_state', StringType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('drug_name', StringType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('country_name', StringType(), False)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"13-Dec-24 17:02:54" - validations - INFO - The Dataframe schema validation is completed
"13-Dec-24 17:02:54" - presc_run_data_transform - INFO - Transform - city_report() is started...
"13-Dec-24 17:02:54" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"13-Dec-24 17:02:54" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"13-Dec-24 17:02:54" - validations - INFO - The dataframe df_city_final schema is 
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('city', StringType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('state_name', StringType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('county_name', StringType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('population', IntegerType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"13-Dec-24 17:02:54" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"13-Dec-24 17:02:54" - validations - INFO - The Dataframe schema validation is completed
"13-Dec-24 17:02:54" - root - INFO - presc_run_pipeline.py is completed
"13-Dec-24 17:12:59" - root - INFO - run_presc_pipeline is started..
"13-Dec-24 17:12:59" - root - INFO - main() is started
"13-Dec-24 17:12:59" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"13-Dec-24 17:13:19" - create_objects - INFO - Spark object is created
"13-Dec-24 17:13:19" - root - INFO - Object created
"13-Dec-24 17:13:24" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 13))]
"13-Dec-24 17:13:24" - validations - INFO - Spark object is validated. Spark object is ready
"13-Dec-24 17:13:24" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 17:13:25" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"13-Dec-24 17:13:25" - presc_run_data_ingest - INFO - the load_files() function is started
"13-Dec-24 17:13:27" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"13-Dec-24 17:13:27" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"13-Dec-24 17:13:28" - validations - INFO - The dataframe count is 28338
"13-Dec-24 17:13:28" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 17:13:28" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"13-Dec-24 17:13:29" - validations - INFO - The dataframe count is 105
"13-Dec-24 17:13:29" - validations - INFO - The dataframe validation by df_count() is completed
"13-Dec-24 17:13:29" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"13-Dec-24 17:13:29" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"13-Dec-24 17:13:29" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"13-Dec-24 17:13:29" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"13-Dec-24 17:13:29" - validations - INFO - The dataframe df_fact_sel schema is 
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('presc_city', StringType(), True)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('presc_state', StringType(), True)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('drug_name', StringType(), True)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('country_name', StringType(), False)
"13-Dec-24 17:13:29" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"13-Dec-24 17:13:29" - validations - INFO - The Dataframe schema validation is completed
"13-Dec-24 17:13:29" - presc_run_data_transform - INFO - Transform - city_report() is started...
"13-Dec-24 17:13:29" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"13-Dec-24 17:13:29" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"13-Dec-24 17:13:29" - presc_run_data_transform - ERROR - Error in the method - top_5_Prescribers(). Please check the Stack Trace. [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `years_of_exp` cannot be resolved. Did you mean one of the following? [`year_exp`, `drug_name`, `presc_id`, `trx_cnt`, `presc_city`].;
'Project [presc_id#141, presc_fullname#199, presc_state#145, country_name#160, 'years_of_exp, trx_cnt#249, total_day_supply#55, total_drug_cost#56]
+- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, cast(trx_cnt#236 as int) AS trx_cnt#249, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
   +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#236, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
      +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199, trx_cnt#147, _we0#237, coalesce(cast(trx_cnt#147 as double), round(_we0#237, 0)) AS trx_cnt#236]
         +- Window [avg(trx_cnt#147) windowspecdefinition(presc_id#141, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#237], [presc_id#141]
            +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199, trx_cnt#147]
               +- Filter atleastnnonnulls(1, drug_name#50)
                  +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
                     +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160, concat_ws( , presc_fname#143, presc_lname#142) AS presc_fullname#199]
                        +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, cast(year_exp#173 as int) AS year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160]
                           +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, regexp_extract(year_exp#64, \d+, 0) AS year_exp#173, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160]
                              +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, year_exp#64, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, USA AS country_name#160]
                                 +- Project [npi#43 AS presc_id#141, nppes_provider_last_org_name#44 AS presc_lname#142, nppes_provider_first_name#45 AS presc_fname#143, nppes_provider_city#46 AS presc_city#144, nppes_provider_state#47 AS presc_state#145, specialty_description#48 AS presc_spclt#146, year_exp#64, drug_name#50, total_claim_count#53 AS trx_cnt#147, total_day_supply#55, total_drug_cost#56]
                                    +- Relation [npi#43,nppes_provider_last_org_name#44,nppes_provider_first_name#45,nppes_provider_city#46,nppes_provider_state#47,specialty_description#48,description_flag#49,drug_name#50,generic_name#51,bene_count#52,total_claim_count#53,total_30_day_fill_count#54,total_day_supply#55,total_drug_cost#56,bene_count_ge65#57,bene_count_ge65_suppress_flag#58,total_claim_count_ge65#59,ge65_suppress_flag#60,total_30_day_fill_count_ge65#61,total_day_supply_ge65#62,total_drug_cost_ge65#63,year_exp#64] csv
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_transform.py", line 60, in top_5_Prescribers
    df_presc_final = df_fact_sel.select("presc_id","presc_fullname","presc_state","country_name","years_of_exp","trx_cnt","total_day_supply","total_drug_cost") \
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 3229, in select
    jdf = self._jdf.select(self._jcols(*cols))
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `years_of_exp` cannot be resolved. Did you mean one of the following? [`year_exp`, `drug_name`, `presc_id`, `trx_cnt`, `presc_city`].;
'Project [presc_id#141, presc_fullname#199, presc_state#145, country_name#160, 'years_of_exp, trx_cnt#249, total_day_supply#55, total_drug_cost#56]
+- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, cast(trx_cnt#236 as int) AS trx_cnt#249, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
   +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#236, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
      +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199, trx_cnt#147, _we0#237, coalesce(cast(trx_cnt#147 as double), round(_we0#237, 0)) AS trx_cnt#236]
         +- Window [avg(trx_cnt#147) windowspecdefinition(presc_id#141, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#237], [presc_id#141]
            +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199, trx_cnt#147]
               +- Filter atleastnnonnulls(1, drug_name#50)
                  +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
                     +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160, concat_ws( , presc_fname#143, presc_lname#142) AS presc_fullname#199]
                        +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, cast(year_exp#173 as int) AS year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160]
                           +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, regexp_extract(year_exp#64, \d+, 0) AS year_exp#173, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160]
                              +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, year_exp#64, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, USA AS country_name#160]
                                 +- Project [npi#43 AS presc_id#141, nppes_provider_last_org_name#44 AS presc_lname#142, nppes_provider_first_name#45 AS presc_fname#143, nppes_provider_city#46 AS presc_city#144, nppes_provider_state#47 AS presc_state#145, specialty_description#48 AS presc_spclt#146, year_exp#64, drug_name#50, total_claim_count#53 AS trx_cnt#147, total_day_supply#55, total_drug_cost#56]
                                    +- Relation [npi#43,nppes_provider_last_org_name#44,nppes_provider_first_name#45,nppes_provider_city#46,nppes_provider_state#47,specialty_description#48,description_flag#49,drug_name#50,generic_name#51,bene_count#52,total_claim_count#53,total_30_day_fill_count#54,total_day_supply#55,total_drug_cost#56,bene_count_ge65#57,bene_count_ge65_suppress_flag#58,total_claim_count_ge65#59,ge65_suppress_flag#60,total_30_day_fill_count_ge65#61,total_day_supply_ge65#62,total_drug_cost_ge65#63,year_exp#64] csv

"13-Dec-24 17:13:29" - root - ERROR - Error occurred in the main() method [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `years_of_exp` cannot be resolved. Did you mean one of the following? [`year_exp`, `drug_name`, `presc_id`, `trx_cnt`, `presc_city`].;
'Project [presc_id#141, presc_fullname#199, presc_state#145, country_name#160, 'years_of_exp, trx_cnt#249, total_day_supply#55, total_drug_cost#56]
+- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, cast(trx_cnt#236 as int) AS trx_cnt#249, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
   +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#236, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
      +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199, trx_cnt#147, _we0#237, coalesce(cast(trx_cnt#147 as double), round(_we0#237, 0)) AS trx_cnt#236]
         +- Window [avg(trx_cnt#147) windowspecdefinition(presc_id#141, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#237], [presc_id#141]
            +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199, trx_cnt#147]
               +- Filter atleastnnonnulls(1, drug_name#50)
                  +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
                     +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160, concat_ws( , presc_fname#143, presc_lname#142) AS presc_fullname#199]
                        +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, cast(year_exp#173 as int) AS year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160]
                           +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, regexp_extract(year_exp#64, \d+, 0) AS year_exp#173, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160]
                              +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, year_exp#64, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, USA AS country_name#160]
                                 +- Project [npi#43 AS presc_id#141, nppes_provider_last_org_name#44 AS presc_lname#142, nppes_provider_first_name#45 AS presc_fname#143, nppes_provider_city#46 AS presc_city#144, nppes_provider_state#47 AS presc_state#145, specialty_description#48 AS presc_spclt#146, year_exp#64, drug_name#50, total_claim_count#53 AS trx_cnt#147, total_day_supply#55, total_drug_cost#56]
                                    +- Relation [npi#43,nppes_provider_last_org_name#44,nppes_provider_first_name#45,nppes_provider_city#46,nppes_provider_state#47,specialty_description#48,description_flag#49,drug_name#50,generic_name#51,bene_count#52,total_claim_count#53,total_30_day_fill_count#54,total_day_supply#55,total_drug_cost#56,bene_count_ge65#57,bene_count_ge65_suppress_flag#58,total_claim_count_ge65#59,ge65_suppress_flag#60,total_30_day_fill_count_ge65#61,total_day_supply_ge65#62,total_drug_cost_ge65#63,year_exp#64] csv
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 68, in main
    df_presc_final = top_5_Prescribers(df_fact_sel)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_transform.py", line 60, in top_5_Prescribers
    df_presc_final = df_fact_sel.select("presc_id","presc_fullname","presc_state","country_name","years_of_exp","trx_cnt","total_day_supply","total_drug_cost") \
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 3229, in select
    jdf = self._jdf.select(self._jcols(*cols))
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `years_of_exp` cannot be resolved. Did you mean one of the following? [`year_exp`, `drug_name`, `presc_id`, `trx_cnt`, `presc_city`].;
'Project [presc_id#141, presc_fullname#199, presc_state#145, country_name#160, 'years_of_exp, trx_cnt#249, total_day_supply#55, total_drug_cost#56]
+- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, cast(trx_cnt#236 as int) AS trx_cnt#249, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
   +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#236, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
      +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199, trx_cnt#147, _we0#237, coalesce(cast(trx_cnt#147 as double), round(_we0#237, 0)) AS trx_cnt#236]
         +- Window [avg(trx_cnt#147) windowspecdefinition(presc_id#141, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#237], [presc_id#141]
            +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199, trx_cnt#147]
               +- Filter atleastnnonnulls(1, drug_name#50)
                  +- Project [presc_id#141, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160, presc_fullname#199]
                     +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160, concat_ws( , presc_fname#143, presc_lname#142) AS presc_fullname#199]
                        +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, cast(year_exp#173 as int) AS year_exp#186, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160]
                           +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, regexp_extract(year_exp#64, \d+, 0) AS year_exp#173, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, country_name#160]
                              +- Project [presc_id#141, presc_lname#142, presc_fname#143, presc_city#144, presc_state#145, presc_spclt#146, year_exp#64, drug_name#50, trx_cnt#147, total_day_supply#55, total_drug_cost#56, USA AS country_name#160]
                                 +- Project [npi#43 AS presc_id#141, nppes_provider_last_org_name#44 AS presc_lname#142, nppes_provider_first_name#45 AS presc_fname#143, nppes_provider_city#46 AS presc_city#144, nppes_provider_state#47 AS presc_state#145, specialty_description#48 AS presc_spclt#146, year_exp#64, drug_name#50, total_claim_count#53 AS trx_cnt#147, total_day_supply#55, total_drug_cost#56]
                                    +- Relation [npi#43,nppes_provider_last_org_name#44,nppes_provider_first_name#45,nppes_provider_city#46,nppes_provider_state#47,specialty_description#48,description_flag#49,drug_name#50,generic_name#51,bene_count#52,total_claim_count#53,total_30_day_fill_count#54,total_day_supply#55,total_drug_cost#56,bene_count_ge65#57,bene_count_ge65_suppress_flag#58,total_claim_count_ge65#59,ge65_suppress_flag#60,total_30_day_fill_count_ge65#61,total_day_supply_ge65#62,total_drug_cost_ge65#63,year_exp#64] csv

"17-Dec-24 16:47:54" - root - INFO - run_presc_pipeline is started..
"17-Dec-24 16:47:54" - root - INFO - main() is started
"17-Dec-24 16:47:54" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"17-Dec-24 16:48:24" - create_objects - INFO - Spark object is created
"17-Dec-24 16:48:24" - root - INFO - Object created
"17-Dec-24 16:48:33" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 17))]
"17-Dec-24 16:48:33" - validations - INFO - Spark object is validated. Spark object is ready
"17-Dec-24 16:48:33" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 16:48:34" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/dimension_city/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"17-Dec-24 16:48:34" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 16:48:38" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"17-Dec-24 16:48:38" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"17-Dec-24 16:48:39" - validations - INFO - The dataframe count is 28338
"17-Dec-24 16:48:39" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 16:48:39" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"17-Dec-24 16:48:39" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 16:48:41" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 16:48:41" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 16:48:41" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"17-Dec-24 16:48:42" - validations - INFO - The dataframe count is 105
"17-Dec-24 16:48:42" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 16:48:42" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"17-Dec-24 16:48:42" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 16:48:43" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"17-Dec-24 16:48:43" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 16:48:43" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"17-Dec-24 16:48:43" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"17-Dec-24 16:48:44" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"17-Dec-24 16:48:44" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"17-Dec-24 16:48:44" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 16:48:44" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 16:48:44" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 16:48:44" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"17-Dec-24 16:48:44" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 16:48:46" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"17-Dec-24 16:48:46" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 16:48:46" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"17-Dec-24 16:48:46" - validations - INFO - The dataframe df_fact_sel schema is 
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('presc_city', StringType(), True)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('drug_name', StringType(), True)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 16:48:46" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 16:48:46" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 16:48:46" - presc_run_data_transform - INFO - Transform - city_report() is started...
"17-Dec-24 16:48:46" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"17-Dec-24 16:48:46" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"17-Dec-24 16:48:47" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"17-Dec-24 16:48:47" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"17-Dec-24 16:48:47" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 16:48:56" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"17-Dec-24 16:48:56" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 16:48:56" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"17-Dec-24 16:48:56" - validations - INFO - The dataframe df_city_final schema is 
"17-Dec-24 16:48:56" - validations - INFO - 	StructField('city', StringType(), True)
"17-Dec-24 16:48:56" - validations - INFO - 	StructField('state_name', StringType(), True)
"17-Dec-24 16:48:56" - validations - INFO - 	StructField('county_name', StringType(), True)
"17-Dec-24 16:48:56" - validations - INFO - 	StructField('population', IntegerType(), True)
"17-Dec-24 16:48:56" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"17-Dec-24 16:48:56" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"17-Dec-24 16:48:56" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"17-Dec-24 16:48:56" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 16:48:56" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"17-Dec-24 16:48:56" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 16:48:58" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"17-Dec-24 16:48:58" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 16:48:58" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"17-Dec-24 16:48:58" - validations - INFO - The dataframe df_presc_final schema is 
"17-Dec-24 16:48:58" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 16:48:58" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 16:48:58" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 16:48:58" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 16:48:58" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 16:48:58" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 16:48:58" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 16:48:58" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 16:48:58" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 16:48:58" - root - INFO - presc_run_pipeline.py is completed
"17-Dec-24 22:00:40" - root - INFO - run_presc_pipeline is started..
"17-Dec-24 22:00:40" - root - INFO - main() is started
"17-Dec-24 22:00:40" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"17-Dec-24 22:01:09" - create_objects - INFO - Spark object is created
"17-Dec-24 22:01:09" - root - INFO - Object created
"17-Dec-24 22:01:19" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 17))]
"17-Dec-24 22:01:19" - validations - INFO - Spark object is validated. Spark object is ready
"17-Dec-24 22:01:19" - root - ERROR - Error occurred in the main() method load_files() missing 2 required positional arguments: 'file_format' and 'header'
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 50, in main
    df_city = load_files(spark=spark, file_dir = "hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet", inferSchema=inferScehma)
TypeError: load_files() missing 2 required positional arguments: 'file_format' and 'header'
"17-Dec-24 22:02:47" - root - INFO - run_presc_pipeline is started..
"17-Dec-24 22:02:47" - root - INFO - main() is started
"17-Dec-24 22:02:47" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"17-Dec-24 22:03:01" - create_objects - INFO - Spark object is created
"17-Dec-24 22:03:01" - root - INFO - Object created
"17-Dec-24 22:03:13" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 17))]
"17-Dec-24 22:03:13" - validations - INFO - Spark object is validated. Spark object is ready
"17-Dec-24 22:03:13" - root - ERROR - Error occurred in the main() method load_files() got an unexpected keyword argument 'inferScehma'
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 50, in main
    df_city = load_files(spark=spark, file_dir = "hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet", inferSchema=inferScehma, file_format='parquet', inferScehma='NA')
TypeError: load_files() got an unexpected keyword argument 'inferScehma'
"17-Dec-24 22:04:39" - root - INFO - run_presc_pipeline is started..
"17-Dec-24 22:04:39" - root - INFO - main() is started
"17-Dec-24 22:04:39" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"17-Dec-24 22:04:49" - create_objects - INFO - Spark object is created
"17-Dec-24 22:04:49" - root - INFO - Object created
"17-Dec-24 22:04:58" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 17))]
"17-Dec-24 22:04:58" - validations - INFO - Spark object is validated. Spark object is ready
"17-Dec-24 22:04:58" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:05:03" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:05:03" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:05:06" - presc_run_data_ingest - INFO - The input file /home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/../staging/fact/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:05:06" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"17-Dec-24 22:05:07" - validations - INFO - The dataframe count is 28338
"17-Dec-24 22:05:07" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:05:07" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"17-Dec-24 22:05:07" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:05:10" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:05:10" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:05:10" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"17-Dec-24 22:05:11" - validations - INFO - The dataframe count is 105
"17-Dec-24 22:05:11" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:05:11" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"17-Dec-24 22:05:11" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:05:11" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"17-Dec-24 22:05:11" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:05:11" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"17-Dec-24 22:05:11" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"17-Dec-24 22:05:11" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"17-Dec-24 22:05:11" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"17-Dec-24 22:05:11" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:05:11" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:05:11" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:05:11" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"17-Dec-24 22:05:11" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:05:13" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"17-Dec-24 22:05:13" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:05:13" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"17-Dec-24 22:05:13" - validations - INFO - The dataframe df_fact_sel schema is 
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('presc_city', StringType(), True)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('drug_name', StringType(), True)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:05:13" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:05:13" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:05:13" - presc_run_data_transform - INFO - Transform - city_report() is started...
"17-Dec-24 22:05:13" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"17-Dec-24 22:05:13" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"17-Dec-24 22:05:13" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"17-Dec-24 22:05:13" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"17-Dec-24 22:05:13" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:05:18" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"17-Dec-24 22:05:18" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:05:18" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"17-Dec-24 22:05:18" - validations - INFO - The dataframe df_city_final schema is 
"17-Dec-24 22:05:18" - validations - INFO - 	StructField('city', StringType(), True)
"17-Dec-24 22:05:18" - validations - INFO - 	StructField('state_name', StringType(), True)
"17-Dec-24 22:05:18" - validations - INFO - 	StructField('county_name', StringType(), True)
"17-Dec-24 22:05:18" - validations - INFO - 	StructField('population', IntegerType(), True)
"17-Dec-24 22:05:18" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"17-Dec-24 22:05:18" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"17-Dec-24 22:05:18" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"17-Dec-24 22:05:18" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:05:18" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"17-Dec-24 22:05:18" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:05:20" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"17-Dec-24 22:05:20" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:05:20" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"17-Dec-24 22:05:20" - validations - INFO - The dataframe df_presc_final schema is 
"17-Dec-24 22:05:20" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:05:20" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:05:20" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:05:20" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:05:20" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:05:20" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:05:20" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:05:20" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:05:20" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:05:20" - root - INFO - presc_run_pipeline.py is completed
"17-Dec-24 22:08:33" - root - INFO - run_presc_pipeline is started..
"17-Dec-24 22:08:33" - root - INFO - main() is started
"17-Dec-24 22:08:33" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"17-Dec-24 22:08:41" - create_objects - INFO - Spark object is created
"17-Dec-24 22:08:41" - root - INFO - Object created
"17-Dec-24 22:08:48" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 17))]
"17-Dec-24 22:08:48" - validations - INFO - Spark object is validated. Spark object is ready
"17-Dec-24 22:08:48" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:08:50" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:08:50" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:08:52" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:08:52" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"17-Dec-24 22:08:53" - validations - INFO - The dataframe count is 28338
"17-Dec-24 22:08:53" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:08:53" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"17-Dec-24 22:08:53" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:08:55" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:08:55" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:08:55" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"17-Dec-24 22:08:55" - validations - INFO - The dataframe count is 105
"17-Dec-24 22:08:55" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:08:55" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"17-Dec-24 22:08:55" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:08:55" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"17-Dec-24 22:08:55" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:08:55" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"17-Dec-24 22:08:55" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"17-Dec-24 22:08:56" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"17-Dec-24 22:08:56" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"17-Dec-24 22:08:56" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:08:56" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:08:56" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:08:56" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"17-Dec-24 22:08:56" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:08:57" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"17-Dec-24 22:08:57" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:08:57" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"17-Dec-24 22:08:57" - validations - INFO - The dataframe df_fact_sel schema is 
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('presc_city', StringType(), True)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('drug_name', StringType(), True)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:08:57" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:08:57" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:08:57" - presc_run_data_transform - INFO - Transform - city_report() is started...
"17-Dec-24 22:08:57" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"17-Dec-24 22:08:57" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"17-Dec-24 22:08:57" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"17-Dec-24 22:08:57" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"17-Dec-24 22:08:57" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:09:01" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"17-Dec-24 22:09:01" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:09:01" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"17-Dec-24 22:09:01" - validations - INFO - The dataframe df_city_final schema is 
"17-Dec-24 22:09:01" - validations - INFO - 	StructField('city', StringType(), True)
"17-Dec-24 22:09:01" - validations - INFO - 	StructField('state_name', StringType(), True)
"17-Dec-24 22:09:01" - validations - INFO - 	StructField('county_name', StringType(), True)
"17-Dec-24 22:09:01" - validations - INFO - 	StructField('population', IntegerType(), True)
"17-Dec-24 22:09:01" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"17-Dec-24 22:09:01" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"17-Dec-24 22:09:01" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"17-Dec-24 22:09:01" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:09:01" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"17-Dec-24 22:09:01" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:09:03" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"17-Dec-24 22:09:03" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:09:03" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"17-Dec-24 22:09:03" - validations - INFO - The dataframe df_presc_final schema is 
"17-Dec-24 22:09:03" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:09:03" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:09:03" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:09:03" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:09:03" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:09:03" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:09:03" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:09:03" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:09:03" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:09:03" - root - INFO - presc_run_pipeline.py is completed
"17-Dec-24 22:32:15" - root - INFO - run_presc_pipeline is started..
"17-Dec-24 22:32:15" - root - INFO - main() is started
"17-Dec-24 22:32:15" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"17-Dec-24 22:32:46" - create_objects - INFO - Spark object is created
"17-Dec-24 22:32:46" - root - INFO - Object created
"17-Dec-24 22:32:54" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 17))]
"17-Dec-24 22:32:54" - validations - INFO - Spark object is validated. Spark object is ready
"17-Dec-24 22:32:54" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:33:01" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:33:01" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:33:05" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:33:05" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"17-Dec-24 22:33:06" - validations - INFO - The dataframe count is 28338
"17-Dec-24 22:33:06" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:33:06" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"17-Dec-24 22:33:06" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:33:15" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:33:15" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:33:15" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"17-Dec-24 22:33:15" - validations - INFO - The dataframe count is 105
"17-Dec-24 22:33:15" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:33:15" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"17-Dec-24 22:33:15" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:33:15" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"17-Dec-24 22:33:15" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:33:15" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"17-Dec-24 22:33:15" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"17-Dec-24 22:33:16" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"17-Dec-24 22:33:16" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"17-Dec-24 22:33:16" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:33:16" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:33:16" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:33:16" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"17-Dec-24 22:33:16" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:33:17" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"17-Dec-24 22:33:17" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:33:17" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"17-Dec-24 22:33:17" - validations - INFO - The dataframe df_fact_sel schema is 
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('presc_city', StringType(), True)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('drug_name', StringType(), True)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:33:17" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:33:17" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:33:17" - presc_run_data_transform - INFO - Transform - city_report() is started...
"17-Dec-24 22:33:17" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"17-Dec-24 22:33:17" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"17-Dec-24 22:33:18" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"17-Dec-24 22:33:18" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"17-Dec-24 22:33:18" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:33:28" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"17-Dec-24 22:33:28" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:33:28" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"17-Dec-24 22:33:28" - validations - INFO - The dataframe df_city_final schema is 
"17-Dec-24 22:33:28" - validations - INFO - 	StructField('city', StringType(), True)
"17-Dec-24 22:33:28" - validations - INFO - 	StructField('state_name', StringType(), True)
"17-Dec-24 22:33:28" - validations - INFO - 	StructField('county_name', StringType(), True)
"17-Dec-24 22:33:28" - validations - INFO - 	StructField('population', IntegerType(), True)
"17-Dec-24 22:33:28" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"17-Dec-24 22:33:28" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"17-Dec-24 22:33:28" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"17-Dec-24 22:33:28" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:33:28" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"17-Dec-24 22:33:28" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:33:30" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"17-Dec-24 22:33:30" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:33:30" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"17-Dec-24 22:33:30" - validations - INFO - The dataframe df_presc_final schema is 
"17-Dec-24 22:33:30" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:33:30" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:33:30" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:33:30" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:33:30" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:33:30" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:33:30" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:33:30" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:33:30" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:33:40" - root - ERROR - Error occurred in the main() method An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 99, in main
    df_city_final.write.csv("src/main/python/final/city_final.csv")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"17-Dec-24 22:35:26" - root - INFO - run_presc_pipeline is started..
"17-Dec-24 22:35:26" - root - INFO - main() is started
"17-Dec-24 22:35:26" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"17-Dec-24 22:35:39" - create_objects - INFO - Spark object is created
"17-Dec-24 22:35:39" - root - INFO - Object created
"17-Dec-24 22:35:48" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 17))]
"17-Dec-24 22:35:48" - validations - INFO - Spark object is validated. Spark object is ready
"17-Dec-24 22:35:48" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:35:52" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:35:52" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:35:59" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:35:59" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"17-Dec-24 22:36:01" - validations - INFO - The dataframe count is 28338
"17-Dec-24 22:36:01" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:36:01" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"17-Dec-24 22:36:01" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:36:04" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:36:04" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:36:04" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"17-Dec-24 22:36:04" - validations - INFO - The dataframe count is 105
"17-Dec-24 22:36:04" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:36:04" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"17-Dec-24 22:36:04" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:36:04" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"17-Dec-24 22:36:04" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:36:04" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"17-Dec-24 22:36:04" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"17-Dec-24 22:36:05" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"17-Dec-24 22:36:05" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"17-Dec-24 22:36:05" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:36:05" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:36:05" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:36:05" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"17-Dec-24 22:36:05" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:36:06" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"17-Dec-24 22:36:06" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:36:06" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"17-Dec-24 22:36:06" - validations - INFO - The dataframe df_fact_sel schema is 
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('presc_city', StringType(), True)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('drug_name', StringType(), True)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:36:06" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:36:06" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:36:06" - presc_run_data_transform - INFO - Transform - city_report() is started...
"17-Dec-24 22:36:07" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"17-Dec-24 22:36:07" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"17-Dec-24 22:36:07" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"17-Dec-24 22:36:07" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"17-Dec-24 22:36:07" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:36:11" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"17-Dec-24 22:36:11" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:36:11" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"17-Dec-24 22:36:11" - validations - INFO - The dataframe df_city_final schema is 
"17-Dec-24 22:36:11" - validations - INFO - 	StructField('city', StringType(), True)
"17-Dec-24 22:36:11" - validations - INFO - 	StructField('state_name', StringType(), True)
"17-Dec-24 22:36:11" - validations - INFO - 	StructField('county_name', StringType(), True)
"17-Dec-24 22:36:11" - validations - INFO - 	StructField('population', IntegerType(), True)
"17-Dec-24 22:36:11" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"17-Dec-24 22:36:11" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"17-Dec-24 22:36:11" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"17-Dec-24 22:36:11" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:36:11" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"17-Dec-24 22:36:11" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:36:13" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"17-Dec-24 22:36:13" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:36:13" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"17-Dec-24 22:36:13" - validations - INFO - The dataframe df_presc_final schema is 
"17-Dec-24 22:36:13" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:36:13" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:36:13" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:36:13" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:36:13" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:36:13" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:36:13" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:36:13" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:36:13" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:36:13" - root - INFO - presc_run_pipeline.py is completed
"17-Dec-24 22:36:51" - root - INFO - run_presc_pipeline is started..
"17-Dec-24 22:36:51" - root - INFO - main() is started
"17-Dec-24 22:36:51" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"17-Dec-24 22:36:58" - create_objects - INFO - Spark object is created
"17-Dec-24 22:36:58" - root - INFO - Object created
"17-Dec-24 22:37:03" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 17))]
"17-Dec-24 22:37:03" - validations - INFO - Spark object is validated. Spark object is ready
"17-Dec-24 22:37:03" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:37:07" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:37:07" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:37:09" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:37:09" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"17-Dec-24 22:37:10" - validations - INFO - The dataframe count is 28338
"17-Dec-24 22:37:10" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:37:10" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"17-Dec-24 22:37:10" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:37:11" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:37:11" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:37:11" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"17-Dec-24 22:37:12" - validations - INFO - The dataframe count is 105
"17-Dec-24 22:37:12" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:37:12" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"17-Dec-24 22:37:12" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:37:12" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"17-Dec-24 22:37:12" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:37:12" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"17-Dec-24 22:37:12" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"17-Dec-24 22:37:12" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"17-Dec-24 22:37:12" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"17-Dec-24 22:37:12" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:37:13" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:37:13" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:37:13" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"17-Dec-24 22:37:13" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:37:14" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"17-Dec-24 22:37:14" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:37:14" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"17-Dec-24 22:37:14" - validations - INFO - The dataframe df_fact_sel schema is 
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('presc_city', StringType(), True)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('drug_name', StringType(), True)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:37:14" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:37:14" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:37:14" - presc_run_data_transform - INFO - Transform - city_report() is started...
"17-Dec-24 22:37:14" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"17-Dec-24 22:37:14" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"17-Dec-24 22:37:14" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"17-Dec-24 22:37:14" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"17-Dec-24 22:37:14" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:37:17" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"17-Dec-24 22:37:17" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:37:17" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"17-Dec-24 22:37:17" - validations - INFO - The dataframe df_city_final schema is 
"17-Dec-24 22:37:17" - validations - INFO - 	StructField('city', StringType(), True)
"17-Dec-24 22:37:17" - validations - INFO - 	StructField('state_name', StringType(), True)
"17-Dec-24 22:37:17" - validations - INFO - 	StructField('county_name', StringType(), True)
"17-Dec-24 22:37:17" - validations - INFO - 	StructField('population', IntegerType(), True)
"17-Dec-24 22:37:17" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"17-Dec-24 22:37:17" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"17-Dec-24 22:37:17" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"17-Dec-24 22:37:17" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:37:17" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"17-Dec-24 22:37:17" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:37:18" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"17-Dec-24 22:37:18" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:37:18" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"17-Dec-24 22:37:18" - validations - INFO - The dataframe df_presc_final schema is 
"17-Dec-24 22:37:18" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:37:18" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:37:18" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:37:18" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:37:18" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:37:18" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:37:18" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:37:18" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:37:18" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:37:19" - root - ERROR - Error occurred in the main() method [PATH_ALREADY_EXISTS] Path file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/src/main/python/final/city_final.csv already exists. Set mode as "overwrite" to overwrite the existing path.
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 99, in main
    df_city_final.write.csv("src/main/python/final/city_final.csv")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [PATH_ALREADY_EXISTS] Path file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/src/main/python/final/city_final.csv already exists. Set mode as "overwrite" to overwrite the existing path.
"17-Dec-24 22:39:00" - root - INFO - run_presc_pipeline is started..
"17-Dec-24 22:39:00" - root - INFO - main() is started
"17-Dec-24 22:39:00" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"17-Dec-24 22:39:06" - create_objects - INFO - Spark object is created
"17-Dec-24 22:39:06" - root - INFO - Object created
"17-Dec-24 22:39:16" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 17))]
"17-Dec-24 22:39:16" - validations - INFO - Spark object is validated. Spark object is ready
"17-Dec-24 22:39:16" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:39:18" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:39:18" - presc_run_data_ingest - INFO - the load_files() function is started
"17-Dec-24 22:39:22" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"17-Dec-24 22:39:22" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"17-Dec-24 22:39:23" - validations - INFO - The dataframe count is 28338
"17-Dec-24 22:39:23" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:39:23" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"17-Dec-24 22:39:23" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:39:25" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:39:25" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:39:25" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"17-Dec-24 22:39:25" - validations - INFO - The dataframe count is 105
"17-Dec-24 22:39:25" - validations - INFO - The dataframe validation by df_count() is completed
"17-Dec-24 22:39:25" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"17-Dec-24 22:39:25" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:39:26" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"17-Dec-24 22:39:26" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:39:26" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"17-Dec-24 22:39:26" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"17-Dec-24 22:39:26" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"17-Dec-24 22:39:26" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"17-Dec-24 22:39:26" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:39:26" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"17-Dec-24 22:39:26" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:39:26" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"17-Dec-24 22:39:26" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:39:27" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"17-Dec-24 22:39:27" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:39:27" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"17-Dec-24 22:39:27" - validations - INFO - The dataframe df_fact_sel schema is 
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('presc_city', StringType(), True)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('drug_name', StringType(), True)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:39:27" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:39:27" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:39:27" - presc_run_data_transform - INFO - Transform - city_report() is started...
"17-Dec-24 22:39:27" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"17-Dec-24 22:39:27" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"17-Dec-24 22:39:27" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"17-Dec-24 22:39:27" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"17-Dec-24 22:39:27" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:39:30" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"17-Dec-24 22:39:30" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:39:30" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"17-Dec-24 22:39:30" - validations - INFO - The dataframe df_city_final schema is 
"17-Dec-24 22:39:30" - validations - INFO - 	StructField('city', StringType(), True)
"17-Dec-24 22:39:30" - validations - INFO - 	StructField('state_name', StringType(), True)
"17-Dec-24 22:39:30" - validations - INFO - 	StructField('county_name', StringType(), True)
"17-Dec-24 22:39:30" - validations - INFO - 	StructField('population', IntegerType(), True)
"17-Dec-24 22:39:30" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"17-Dec-24 22:39:30" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"17-Dec-24 22:39:30" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"17-Dec-24 22:39:30" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:39:30" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"17-Dec-24 22:39:30" - validations - INFO - The dataframe top 10 records are 
"17-Dec-24 22:39:31" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"17-Dec-24 22:39:31" - validations - INFO - The Dataframe validation by top10 records is completed
"17-Dec-24 22:39:31" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"17-Dec-24 22:39:31" - validations - INFO - The dataframe df_presc_final schema is 
"17-Dec-24 22:39:31" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"17-Dec-24 22:39:31" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"17-Dec-24 22:39:31" - validations - INFO - 	StructField('presc_state', StringType(), True)
"17-Dec-24 22:39:31" - validations - INFO - 	StructField('country_name', StringType(), False)
"17-Dec-24 22:39:31" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"17-Dec-24 22:39:31" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"17-Dec-24 22:39:31" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"17-Dec-24 22:39:31" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"17-Dec-24 22:39:31" - validations - INFO - The Dataframe schema validation is completed
"17-Dec-24 22:39:34" - root - ERROR - Error occurred in the main() method An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 99, in main
    df_city_final.write.csv("../final/city_final.csv")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"18-Dec-24 10:32:46" - root - INFO - run_presc_pipeline is started..
"18-Dec-24 10:32:46" - root - INFO - main() is started
"18-Dec-24 10:32:46" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"18-Dec-24 10:33:13" - create_objects - INFO - Spark object is created
"18-Dec-24 10:33:13" - root - INFO - Object created
"18-Dec-24 10:33:24" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 18))]
"18-Dec-24 10:33:24" - validations - INFO - Spark object is validated. Spark object is ready
"18-Dec-24 10:33:24" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:33:33" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:33:33" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:33:36" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:33:36" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"18-Dec-24 10:33:37" - validations - INFO - The dataframe count is 28338
"18-Dec-24 10:33:37" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:33:37" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"18-Dec-24 10:33:37" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:33:40" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:33:40" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:33:40" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"18-Dec-24 10:33:40" - validations - INFO - The dataframe count is 105
"18-Dec-24 10:33:40" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:33:40" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"18-Dec-24 10:33:40" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:33:40" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"18-Dec-24 10:33:40" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:33:40" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"18-Dec-24 10:33:40" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"18-Dec-24 10:33:42" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"18-Dec-24 10:33:42" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"18-Dec-24 10:33:42" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:33:43" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:33:43" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:33:43" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"18-Dec-24 10:33:43" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:33:52" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"18-Dec-24 10:33:52" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:33:52" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"18-Dec-24 10:33:52" - validations - INFO - The dataframe df_fact_sel schema is 
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('presc_city', StringType(), True)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('drug_name', StringType(), True)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:33:52" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:33:52" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:33:52" - presc_run_data_transform - INFO - Transform - city_report() is started...
"18-Dec-24 10:33:53" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"18-Dec-24 10:33:53" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"18-Dec-24 10:33:53" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"18-Dec-24 10:33:53" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"18-Dec-24 10:33:53" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:33:56" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"18-Dec-24 10:33:56" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:33:56" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"18-Dec-24 10:33:56" - validations - INFO - The dataframe df_city_final schema is 
"18-Dec-24 10:33:56" - validations - INFO - 	StructField('city', StringType(), True)
"18-Dec-24 10:33:56" - validations - INFO - 	StructField('state_name', StringType(), True)
"18-Dec-24 10:33:56" - validations - INFO - 	StructField('county_name', StringType(), True)
"18-Dec-24 10:33:56" - validations - INFO - 	StructField('population', IntegerType(), True)
"18-Dec-24 10:33:56" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"18-Dec-24 10:33:56" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"18-Dec-24 10:33:56" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"18-Dec-24 10:33:56" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:33:56" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"18-Dec-24 10:33:56" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:33:58" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"18-Dec-24 10:33:58" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:33:58" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"18-Dec-24 10:33:58" - validations - INFO - The dataframe df_presc_final schema is 
"18-Dec-24 10:33:58" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:33:58" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:33:58" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:33:58" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:33:58" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:33:58" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:33:58" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:33:58" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:33:58" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:33:58" - root - INFO - presc_run_pipeline.py is completed
"18-Dec-24 10:36:40" - root - INFO - run_presc_pipeline is started..
"18-Dec-24 10:36:40" - root - INFO - main() is started
"18-Dec-24 10:36:40" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"18-Dec-24 10:37:11" - create_objects - INFO - Spark object is created
"18-Dec-24 10:37:11" - root - INFO - Object created
"18-Dec-24 10:37:21" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 18))]
"18-Dec-24 10:37:21" - validations - INFO - Spark object is validated. Spark object is ready
"18-Dec-24 10:37:21" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:37:26" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:37:26" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:37:31" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:37:31" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"18-Dec-24 10:37:33" - validations - INFO - The dataframe count is 28338
"18-Dec-24 10:37:33" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:37:33" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"18-Dec-24 10:37:33" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:37:35" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:37:35" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:37:35" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"18-Dec-24 10:37:36" - validations - INFO - The dataframe count is 105
"18-Dec-24 10:37:36" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:37:36" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"18-Dec-24 10:37:36" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:37:36" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"18-Dec-24 10:37:36" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:37:36" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"18-Dec-24 10:37:36" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"18-Dec-24 10:37:36" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"18-Dec-24 10:37:36" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"18-Dec-24 10:37:36" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:37:37" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:37:37" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:37:37" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"18-Dec-24 10:37:37" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:37:38" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"18-Dec-24 10:37:38" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:37:38" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"18-Dec-24 10:37:38" - validations - INFO - The dataframe df_fact_sel schema is 
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('presc_city', StringType(), True)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('drug_name', StringType(), True)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:37:38" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:37:38" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:37:38" - presc_run_data_transform - INFO - Transform - city_report() is started...
"18-Dec-24 10:37:38" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"18-Dec-24 10:37:38" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"18-Dec-24 10:37:38" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"18-Dec-24 10:37:38" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"18-Dec-24 10:37:38" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:37:43" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"18-Dec-24 10:37:43" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:37:43" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"18-Dec-24 10:37:43" - validations - INFO - The dataframe df_city_final schema is 
"18-Dec-24 10:37:43" - validations - INFO - 	StructField('city', StringType(), True)
"18-Dec-24 10:37:43" - validations - INFO - 	StructField('state_name', StringType(), True)
"18-Dec-24 10:37:43" - validations - INFO - 	StructField('county_name', StringType(), True)
"18-Dec-24 10:37:43" - validations - INFO - 	StructField('population', IntegerType(), True)
"18-Dec-24 10:37:43" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"18-Dec-24 10:37:43" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"18-Dec-24 10:37:43" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"18-Dec-24 10:37:43" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:37:43" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"18-Dec-24 10:37:43" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:37:44" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"18-Dec-24 10:37:44" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:37:44" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"18-Dec-24 10:37:44" - validations - INFO - The dataframe df_presc_final schema is 
"18-Dec-24 10:37:44" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:37:44" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:37:44" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:37:44" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:37:44" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:37:44" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:37:44" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:37:44" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:37:44" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:37:46" - root - ERROR - Error occurred in the main() method An error occurred while calling o244.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 104, in main
    df_city_final.write.mode("overwrite").option("header", "true").csv("../final/city_final.csv")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o244.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city_final.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"18-Dec-24 10:40:44" - root - INFO - run_presc_pipeline is started..
"18-Dec-24 10:40:44" - root - INFO - main() is started
"18-Dec-24 10:40:44" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"18-Dec-24 10:41:02" - create_objects - INFO - Spark object is created
"18-Dec-24 10:41:02" - root - INFO - Object created
"18-Dec-24 10:41:17" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 18))]
"18-Dec-24 10:41:17" - validations - INFO - Spark object is validated. Spark object is ready
"18-Dec-24 10:41:17" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:41:21" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:41:21" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:41:25" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:41:25" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"18-Dec-24 10:41:26" - validations - INFO - The dataframe count is 28338
"18-Dec-24 10:41:26" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:41:26" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"18-Dec-24 10:41:26" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:41:29" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:41:29" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:41:29" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"18-Dec-24 10:41:29" - validations - INFO - The dataframe count is 105
"18-Dec-24 10:41:29" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:41:29" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"18-Dec-24 10:41:29" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:41:31" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"18-Dec-24 10:41:31" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:41:31" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"18-Dec-24 10:41:31" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"18-Dec-24 10:41:31" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"18-Dec-24 10:41:31" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"18-Dec-24 10:41:31" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:41:32" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:41:32" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:41:32" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"18-Dec-24 10:41:32" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:41:33" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"18-Dec-24 10:41:33" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:41:33" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"18-Dec-24 10:41:33" - validations - INFO - The dataframe df_fact_sel schema is 
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('presc_city', StringType(), True)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('drug_name', StringType(), True)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:41:33" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:41:33" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:41:33" - presc_run_data_transform - INFO - Transform - city_report() is started...
"18-Dec-24 10:41:33" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"18-Dec-24 10:41:33" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"18-Dec-24 10:41:33" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"18-Dec-24 10:41:33" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"18-Dec-24 10:41:33" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:41:40" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"18-Dec-24 10:41:40" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:41:40" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"18-Dec-24 10:41:40" - validations - INFO - The dataframe df_city_final schema is 
"18-Dec-24 10:41:40" - validations - INFO - 	StructField('city', StringType(), True)
"18-Dec-24 10:41:40" - validations - INFO - 	StructField('state_name', StringType(), True)
"18-Dec-24 10:41:40" - validations - INFO - 	StructField('county_name', StringType(), True)
"18-Dec-24 10:41:40" - validations - INFO - 	StructField('population', IntegerType(), True)
"18-Dec-24 10:41:40" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"18-Dec-24 10:41:40" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"18-Dec-24 10:41:40" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"18-Dec-24 10:41:40" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:41:40" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"18-Dec-24 10:41:40" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:41:42" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"18-Dec-24 10:41:42" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:41:42" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"18-Dec-24 10:41:42" - validations - INFO - The dataframe df_presc_final schema is 
"18-Dec-24 10:41:42" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:41:42" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:41:42" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:41:42" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:41:42" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:41:42" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:41:42" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:41:42" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:41:42" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:41:48" - root - ERROR - Error occurred in the main() method An error occurred while calling o244.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 104, in main
    df_city_final.write.mode("overwrite").option("header", "true").csv("../final")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o244.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"18-Dec-24 10:43:02" - root - INFO - run_presc_pipeline is started..
"18-Dec-24 10:43:02" - root - INFO - main() is started
"18-Dec-24 10:43:02" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"18-Dec-24 10:43:29" - create_objects - INFO - Spark object is created
"18-Dec-24 10:43:29" - root - INFO - Object created
"18-Dec-24 10:43:37" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 18))]
"18-Dec-24 10:43:37" - validations - INFO - Spark object is validated. Spark object is ready
"18-Dec-24 10:43:37" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:43:41" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:43:41" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:43:45" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:43:45" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"18-Dec-24 10:43:46" - validations - INFO - The dataframe count is 28338
"18-Dec-24 10:43:46" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:43:46" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"18-Dec-24 10:43:46" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:43:49" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:43:49" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:43:49" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"18-Dec-24 10:43:49" - validations - INFO - The dataframe count is 105
"18-Dec-24 10:43:49" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:43:49" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"18-Dec-24 10:43:49" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:43:49" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"18-Dec-24 10:43:49" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:43:49" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"18-Dec-24 10:43:49" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"18-Dec-24 10:43:50" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"18-Dec-24 10:43:50" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"18-Dec-24 10:43:50" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:43:50" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:43:50" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:43:50" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"18-Dec-24 10:43:50" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:43:51" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"18-Dec-24 10:43:51" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:43:51" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"18-Dec-24 10:43:51" - validations - INFO - The dataframe df_fact_sel schema is 
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('presc_city', StringType(), True)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('drug_name', StringType(), True)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:43:51" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:43:51" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:43:51" - presc_run_data_transform - INFO - Transform - city_report() is started...
"18-Dec-24 10:43:51" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"18-Dec-24 10:43:51" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"18-Dec-24 10:43:51" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"18-Dec-24 10:43:51" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"18-Dec-24 10:43:51" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:43:56" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"18-Dec-24 10:43:56" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:43:56" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"18-Dec-24 10:43:56" - validations - INFO - The dataframe df_city_final schema is 
"18-Dec-24 10:43:56" - validations - INFO - 	StructField('city', StringType(), True)
"18-Dec-24 10:43:56" - validations - INFO - 	StructField('state_name', StringType(), True)
"18-Dec-24 10:43:56" - validations - INFO - 	StructField('county_name', StringType(), True)
"18-Dec-24 10:43:56" - validations - INFO - 	StructField('population', IntegerType(), True)
"18-Dec-24 10:43:56" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"18-Dec-24 10:43:56" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"18-Dec-24 10:43:56" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"18-Dec-24 10:43:56" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:43:56" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"18-Dec-24 10:43:56" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:43:57" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"18-Dec-24 10:43:57" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:43:57" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"18-Dec-24 10:43:57" - validations - INFO - The dataframe df_presc_final schema is 
"18-Dec-24 10:43:57" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:43:57" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:43:57" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:43:57" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:43:57" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:43:57" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:43:57" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:43:57" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:43:57" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:43:57" - root - INFO - presc_run_pipeline.py is completed
"18-Dec-24 10:51:15" - root - INFO - run_presc_pipeline is started..
"18-Dec-24 10:51:15" - root - INFO - main() is started
"18-Dec-24 10:51:15" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"18-Dec-24 10:51:30" - create_objects - INFO - Spark object is created
"18-Dec-24 10:51:30" - root - INFO - Object created
"18-Dec-24 10:51:39" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 18))]
"18-Dec-24 10:51:39" - validations - INFO - Spark object is validated. Spark object is ready
"18-Dec-24 10:51:39" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:51:43" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:51:43" - presc_run_data_ingest - INFO - the load_files() function is started
"18-Dec-24 10:51:50" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"18-Dec-24 10:51:50" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"18-Dec-24 10:51:52" - validations - INFO - The dataframe count is 28338
"18-Dec-24 10:51:52" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:51:52" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"18-Dec-24 10:51:52" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:51:56" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:51:56" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:51:56" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"18-Dec-24 10:51:56" - validations - INFO - The dataframe count is 105
"18-Dec-24 10:51:56" - validations - INFO - The dataframe validation by df_count() is completed
"18-Dec-24 10:51:56" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"18-Dec-24 10:51:56" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:51:57" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"18-Dec-24 10:51:57" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:51:57" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"18-Dec-24 10:51:57" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"18-Dec-24 10:51:57" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"18-Dec-24 10:51:57" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"18-Dec-24 10:51:57" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:51:57" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"18-Dec-24 10:51:57" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:51:57" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"18-Dec-24 10:51:57" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:51:58" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"18-Dec-24 10:51:58" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:51:58" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"18-Dec-24 10:51:58" - validations - INFO - The dataframe df_fact_sel schema is 
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('presc_city', StringType(), True)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('drug_name', StringType(), True)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:51:58" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:51:58" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:51:58" - presc_run_data_transform - INFO - Transform - city_report() is started...
"18-Dec-24 10:51:59" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"18-Dec-24 10:51:59" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"18-Dec-24 10:51:59" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"18-Dec-24 10:51:59" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"18-Dec-24 10:51:59" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:52:02" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"18-Dec-24 10:52:02" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:52:02" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"18-Dec-24 10:52:02" - validations - INFO - The dataframe df_city_final schema is 
"18-Dec-24 10:52:02" - validations - INFO - 	StructField('city', StringType(), True)
"18-Dec-24 10:52:02" - validations - INFO - 	StructField('state_name', StringType(), True)
"18-Dec-24 10:52:02" - validations - INFO - 	StructField('county_name', StringType(), True)
"18-Dec-24 10:52:02" - validations - INFO - 	StructField('population', IntegerType(), True)
"18-Dec-24 10:52:02" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"18-Dec-24 10:52:02" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"18-Dec-24 10:52:02" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"18-Dec-24 10:52:02" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:52:02" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"18-Dec-24 10:52:02" - validations - INFO - The dataframe top 10 records are 
"18-Dec-24 10:52:03" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"18-Dec-24 10:52:03" - validations - INFO - The Dataframe validation by top10 records is completed
"18-Dec-24 10:52:03" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"18-Dec-24 10:52:03" - validations - INFO - The dataframe df_presc_final schema is 
"18-Dec-24 10:52:03" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"18-Dec-24 10:52:03" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"18-Dec-24 10:52:03" - validations - INFO - 	StructField('presc_state', StringType(), True)
"18-Dec-24 10:52:03" - validations - INFO - 	StructField('country_name', StringType(), False)
"18-Dec-24 10:52:03" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"18-Dec-24 10:52:03" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"18-Dec-24 10:52:03" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"18-Dec-24 10:52:03" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"18-Dec-24 10:52:03" - validations - INFO - The Dataframe schema validation is completed
"18-Dec-24 10:52:06" - root - ERROR - Error occurred in the main() method An error occurred while calling o244.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 104, in main
    df_city_final.write.mode("overwrite").option("header", "true").csv("../final")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o244.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.0.109 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"20-Dec-24 16:33:26" - root - INFO - run_presc_pipeline is started..
"20-Dec-24 16:33:26" - root - INFO - main() is started
"20-Dec-24 16:33:26" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"20-Dec-24 16:33:43" - create_objects - INFO - Spark object is created
"20-Dec-24 16:33:43" - root - INFO - Object created
"20-Dec-24 16:33:51" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 20))]
"20-Dec-24 16:33:51" - validations - INFO - Spark object is validated. Spark object is ready
"20-Dec-24 16:33:51" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:34:01" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:34:01" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:34:08" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:34:08" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"20-Dec-24 16:34:09" - validations - INFO - The dataframe count is 28338
"20-Dec-24 16:34:09" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:34:09" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"20-Dec-24 16:34:09" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:34:13" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:34:13" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:34:13" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"20-Dec-24 16:34:13" - validations - INFO - The dataframe count is 105
"20-Dec-24 16:34:13" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:34:13" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"20-Dec-24 16:34:13" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:34:13" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"20-Dec-24 16:34:13" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:34:13" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"20-Dec-24 16:34:13" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"20-Dec-24 16:34:14" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"20-Dec-24 16:34:14" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"20-Dec-24 16:34:14" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:34:14" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:34:14" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:34:14" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"20-Dec-24 16:34:14" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:34:16" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"20-Dec-24 16:34:16" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:34:16" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"20-Dec-24 16:34:16" - validations - INFO - The dataframe df_fact_sel schema is 
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('presc_city', StringType(), True)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('drug_name', StringType(), True)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:34:16" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:34:16" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:34:16" - presc_run_data_transform - INFO - Transform - city_report() is started...
"20-Dec-24 16:34:16" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"20-Dec-24 16:34:16" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"20-Dec-24 16:34:16" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"20-Dec-24 16:34:16" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"20-Dec-24 16:34:16" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:34:24" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"20-Dec-24 16:34:24" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:34:24" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"20-Dec-24 16:34:24" - validations - INFO - The dataframe df_city_final schema is 
"20-Dec-24 16:34:24" - validations - INFO - 	StructField('city', StringType(), True)
"20-Dec-24 16:34:24" - validations - INFO - 	StructField('state_name', StringType(), True)
"20-Dec-24 16:34:24" - validations - INFO - 	StructField('county_name', StringType(), True)
"20-Dec-24 16:34:24" - validations - INFO - 	StructField('population', IntegerType(), True)
"20-Dec-24 16:34:24" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"20-Dec-24 16:34:24" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"20-Dec-24 16:34:24" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"20-Dec-24 16:34:24" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:34:24" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"20-Dec-24 16:34:24" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:34:25" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"20-Dec-24 16:34:25" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:34:25" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"20-Dec-24 16:34:25" - validations - INFO - The dataframe df_presc_final schema is 
"20-Dec-24 16:34:25" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:34:25" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:34:25" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:34:25" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:34:25" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:34:25" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:34:25" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:34:25" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:34:25" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:34:28" - root - ERROR - Error occurred in the main() method An error occurred while calling o244.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 104, in main
    df_city_final.write.mode("overwrite").option("header", "true").csv("/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o244.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"20-Dec-24 16:35:43" - root - INFO - run_presc_pipeline is started..
"20-Dec-24 16:35:43" - root - INFO - main() is started
"20-Dec-24 16:35:43" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"20-Dec-24 16:35:49" - create_objects - INFO - Spark object is created
"20-Dec-24 16:35:49" - root - INFO - Object created
"20-Dec-24 16:35:53" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 20))]
"20-Dec-24 16:35:53" - validations - INFO - Spark object is validated. Spark object is ready
"20-Dec-24 16:35:53" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:35:55" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:35:55" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:35:58" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:35:58" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"20-Dec-24 16:35:59" - validations - INFO - The dataframe count is 28338
"20-Dec-24 16:35:59" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:35:59" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"20-Dec-24 16:35:59" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:36:00" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:36:00" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:36:00" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"20-Dec-24 16:36:00" - validations - INFO - The dataframe count is 105
"20-Dec-24 16:36:00" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:36:00" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"20-Dec-24 16:36:00" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:36:00" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"20-Dec-24 16:36:00" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:36:00" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"20-Dec-24 16:36:00" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"20-Dec-24 16:36:01" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"20-Dec-24 16:36:01" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"20-Dec-24 16:36:01" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:36:01" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:36:01" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:36:01" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"20-Dec-24 16:36:01" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:36:02" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"20-Dec-24 16:36:02" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:36:02" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"20-Dec-24 16:36:02" - validations - INFO - The dataframe df_fact_sel schema is 
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('presc_city', StringType(), True)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('drug_name', StringType(), True)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:36:02" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:36:02" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:36:02" - presc_run_data_transform - INFO - Transform - city_report() is started...
"20-Dec-24 16:36:02" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"20-Dec-24 16:36:02" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"20-Dec-24 16:36:02" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"20-Dec-24 16:36:02" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"20-Dec-24 16:36:02" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:36:07" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"20-Dec-24 16:36:07" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:36:07" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"20-Dec-24 16:36:07" - validations - INFO - The dataframe df_city_final schema is 
"20-Dec-24 16:36:07" - validations - INFO - 	StructField('city', StringType(), True)
"20-Dec-24 16:36:07" - validations - INFO - 	StructField('state_name', StringType(), True)
"20-Dec-24 16:36:07" - validations - INFO - 	StructField('county_name', StringType(), True)
"20-Dec-24 16:36:07" - validations - INFO - 	StructField('population', IntegerType(), True)
"20-Dec-24 16:36:07" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"20-Dec-24 16:36:07" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"20-Dec-24 16:36:07" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"20-Dec-24 16:36:07" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:36:07" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"20-Dec-24 16:36:07" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:36:08" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"20-Dec-24 16:36:08" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:36:08" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"20-Dec-24 16:36:08" - validations - INFO - The dataframe df_presc_final schema is 
"20-Dec-24 16:36:08" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:36:08" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:36:08" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:36:08" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:36:08" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:36:08" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:36:08" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:36:08" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:36:08" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:36:12" - root - INFO - presc_run_pipeline.py is completed
"20-Dec-24 16:37:09" - root - INFO - run_presc_pipeline is started..
"20-Dec-24 16:37:09" - root - INFO - main() is started
"20-Dec-24 16:37:09" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"20-Dec-24 16:37:16" - create_objects - INFO - Spark object is created
"20-Dec-24 16:37:16" - root - INFO - Object created
"20-Dec-24 16:37:21" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 20))]
"20-Dec-24 16:37:21" - validations - INFO - Spark object is validated. Spark object is ready
"20-Dec-24 16:37:21" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:37:23" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:37:23" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:37:29" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:37:29" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"20-Dec-24 16:37:31" - validations - INFO - The dataframe count is 28338
"20-Dec-24 16:37:31" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:37:31" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"20-Dec-24 16:37:31" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:37:34" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:37:34" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:37:34" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"20-Dec-24 16:37:35" - validations - INFO - The dataframe count is 105
"20-Dec-24 16:37:35" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:37:35" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"20-Dec-24 16:37:35" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:37:36" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"20-Dec-24 16:37:36" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:37:36" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"20-Dec-24 16:37:36" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"20-Dec-24 16:37:37" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"20-Dec-24 16:37:37" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"20-Dec-24 16:37:37" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:37:38" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:37:38" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:37:38" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"20-Dec-24 16:37:38" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:37:40" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"20-Dec-24 16:37:40" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:37:40" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"20-Dec-24 16:37:40" - validations - INFO - The dataframe df_fact_sel schema is 
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('presc_city', StringType(), True)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('drug_name', StringType(), True)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:37:40" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:37:40" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:37:40" - presc_run_data_transform - INFO - Transform - city_report() is started...
"20-Dec-24 16:37:40" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"20-Dec-24 16:37:40" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"20-Dec-24 16:37:41" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"20-Dec-24 16:37:41" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"20-Dec-24 16:37:41" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:37:45" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"20-Dec-24 16:37:45" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:37:45" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"20-Dec-24 16:37:45" - validations - INFO - The dataframe df_city_final schema is 
"20-Dec-24 16:37:45" - validations - INFO - 	StructField('city', StringType(), True)
"20-Dec-24 16:37:45" - validations - INFO - 	StructField('state_name', StringType(), True)
"20-Dec-24 16:37:45" - validations - INFO - 	StructField('county_name', StringType(), True)
"20-Dec-24 16:37:45" - validations - INFO - 	StructField('population', IntegerType(), True)
"20-Dec-24 16:37:45" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"20-Dec-24 16:37:45" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"20-Dec-24 16:37:45" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"20-Dec-24 16:37:45" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:37:45" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"20-Dec-24 16:37:45" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:37:47" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"20-Dec-24 16:37:47" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:37:47" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"20-Dec-24 16:37:47" - validations - INFO - The dataframe df_presc_final schema is 
"20-Dec-24 16:37:47" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:37:47" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:37:47" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:37:47" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:37:47" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:37:47" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:37:47" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:37:47" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:37:47" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:37:50" - root - ERROR - Error occurred in the main() method An error occurred while calling o243.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 104, in main
    df_city_final.write.mode("overwrite").csv("/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.csv")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o243.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"20-Dec-24 16:40:21" - root - INFO - run_presc_pipeline is started..
"20-Dec-24 16:40:21" - root - INFO - main() is started
"20-Dec-24 16:40:21" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"20-Dec-24 16:40:37" - create_objects - INFO - Spark object is created
"20-Dec-24 16:40:37" - root - INFO - Object created
"20-Dec-24 16:40:47" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 20))]
"20-Dec-24 16:40:47" - validations - INFO - Spark object is validated. Spark object is ready
"20-Dec-24 16:40:47" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:40:50" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:40:50" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:40:53" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:40:53" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"20-Dec-24 16:40:55" - validations - INFO - The dataframe count is 28338
"20-Dec-24 16:40:55" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:40:55" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"20-Dec-24 16:40:55" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:40:57" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:40:57" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:40:57" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"20-Dec-24 16:40:57" - validations - INFO - The dataframe count is 105
"20-Dec-24 16:40:57" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:40:57" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"20-Dec-24 16:40:57" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:40:57" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"20-Dec-24 16:40:57" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:40:57" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"20-Dec-24 16:40:58" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"20-Dec-24 16:40:58" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"20-Dec-24 16:40:58" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"20-Dec-24 16:40:58" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:40:58" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:40:58" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:40:58" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"20-Dec-24 16:40:58" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:40:59" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"20-Dec-24 16:40:59" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:40:59" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"20-Dec-24 16:40:59" - validations - INFO - The dataframe df_fact_sel schema is 
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('presc_city', StringType(), True)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('drug_name', StringType(), True)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:40:59" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:40:59" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:40:59" - presc_run_data_transform - INFO - Transform - city_report() is started...
"20-Dec-24 16:40:59" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"20-Dec-24 16:40:59" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"20-Dec-24 16:41:00" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"20-Dec-24 16:41:00" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"20-Dec-24 16:41:00" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:41:03" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"20-Dec-24 16:41:03" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:41:03" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"20-Dec-24 16:41:03" - validations - INFO - The dataframe df_city_final schema is 
"20-Dec-24 16:41:03" - validations - INFO - 	StructField('city', StringType(), True)
"20-Dec-24 16:41:03" - validations - INFO - 	StructField('state_name', StringType(), True)
"20-Dec-24 16:41:03" - validations - INFO - 	StructField('county_name', StringType(), True)
"20-Dec-24 16:41:03" - validations - INFO - 	StructField('population', IntegerType(), True)
"20-Dec-24 16:41:03" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"20-Dec-24 16:41:03" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"20-Dec-24 16:41:03" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"20-Dec-24 16:41:03" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:41:03" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"20-Dec-24 16:41:03" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:41:05" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"20-Dec-24 16:41:05" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:41:05" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"20-Dec-24 16:41:05" - validations - INFO - The dataframe df_presc_final schema is 
"20-Dec-24 16:41:05" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:41:05" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:41:05" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:41:05" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:41:05" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:41:05" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:41:05" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:41:05" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:41:05" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:41:09" - root - ERROR - Error occurred in the main() method An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/tmp/city.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/tmp/city.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 112, in main
    df_city_final.write.csv("/tmp/city.csv")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/tmp/city.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/tmp/city.csv.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"20-Dec-24 16:42:00" - root - INFO - run_presc_pipeline is started..
"20-Dec-24 16:42:00" - root - INFO - main() is started
"20-Dec-24 16:42:00" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"20-Dec-24 16:42:07" - create_objects - INFO - Spark object is created
"20-Dec-24 16:42:07" - root - INFO - Object created
"20-Dec-24 16:42:12" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 20))]
"20-Dec-24 16:42:12" - validations - INFO - Spark object is validated. Spark object is ready
"20-Dec-24 16:42:12" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:42:14" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:42:14" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:42:16" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:42:16" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"20-Dec-24 16:42:17" - validations - INFO - The dataframe count is 28338
"20-Dec-24 16:42:17" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:42:17" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"20-Dec-24 16:42:17" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:42:18" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:42:18" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:42:18" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"20-Dec-24 16:42:19" - validations - INFO - The dataframe count is 105
"20-Dec-24 16:42:19" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:42:19" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"20-Dec-24 16:42:19" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:42:19" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"20-Dec-24 16:42:19" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:42:19" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"20-Dec-24 16:42:19" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"20-Dec-24 16:42:19" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"20-Dec-24 16:42:19" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"20-Dec-24 16:42:19" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:42:19" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:42:19" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:42:19" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"20-Dec-24 16:42:19" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:42:21" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"20-Dec-24 16:42:21" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:42:21" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"20-Dec-24 16:42:21" - validations - INFO - The dataframe df_fact_sel schema is 
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('presc_city', StringType(), True)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('drug_name', StringType(), True)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:42:21" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:42:21" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:42:21" - presc_run_data_transform - INFO - Transform - city_report() is started...
"20-Dec-24 16:42:21" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"20-Dec-24 16:42:21" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"20-Dec-24 16:42:21" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"20-Dec-24 16:42:21" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"20-Dec-24 16:42:21" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:42:24" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"20-Dec-24 16:42:24" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:42:24" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"20-Dec-24 16:42:24" - validations - INFO - The dataframe df_city_final schema is 
"20-Dec-24 16:42:24" - validations - INFO - 	StructField('city', StringType(), True)
"20-Dec-24 16:42:24" - validations - INFO - 	StructField('state_name', StringType(), True)
"20-Dec-24 16:42:24" - validations - INFO - 	StructField('county_name', StringType(), True)
"20-Dec-24 16:42:24" - validations - INFO - 	StructField('population', IntegerType(), True)
"20-Dec-24 16:42:24" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"20-Dec-24 16:42:24" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"20-Dec-24 16:42:24" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"20-Dec-24 16:42:24" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:42:24" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"20-Dec-24 16:42:24" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:42:25" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"20-Dec-24 16:42:25" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:42:25" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"20-Dec-24 16:42:25" - validations - INFO - The dataframe df_presc_final schema is 
"20-Dec-24 16:42:25" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:42:25" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:42:25" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:42:25" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:42:25" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:42:25" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:42:25" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:42:25" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:42:25" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:42:28" - root - ERROR - Error occurred in the main() method An error occurred while calling o242.parquet.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/tmp/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:802)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/tmp/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 112, in main
    df_city_final.write.parquet("/tmp/city/")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1721, in parquet
    self._jwrite.parquet(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o242.parquet.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/tmp/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:802)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/tmp/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"20-Dec-24 16:44:09" - root - INFO - run_presc_pipeline is started..
"20-Dec-24 16:44:09" - root - INFO - main() is started
"20-Dec-24 16:44:09" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"20-Dec-24 16:44:21" - create_objects - INFO - Spark object is created
"20-Dec-24 16:44:21" - root - INFO - Object created
"20-Dec-24 16:44:31" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 20))]
"20-Dec-24 16:44:31" - validations - INFO - Spark object is validated. Spark object is ready
"20-Dec-24 16:44:31" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:44:39" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:44:39" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:44:44" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:44:44" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"20-Dec-24 16:44:47" - validations - INFO - The dataframe count is 28338
"20-Dec-24 16:44:47" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:44:47" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"20-Dec-24 16:44:47" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:44:51" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:44:51" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:44:51" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"20-Dec-24 16:44:52" - validations - INFO - The dataframe count is 105
"20-Dec-24 16:44:52" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:44:52" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"20-Dec-24 16:44:52" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:44:53" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"20-Dec-24 16:44:53" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:44:53" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"20-Dec-24 16:44:53" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"20-Dec-24 16:44:53" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"20-Dec-24 16:44:53" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"20-Dec-24 16:44:53" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:44:54" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:44:54" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:44:54" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"20-Dec-24 16:44:54" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:44:58" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"20-Dec-24 16:44:58" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:44:58" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"20-Dec-24 16:44:58" - validations - INFO - The dataframe df_fact_sel schema is 
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('presc_city', StringType(), True)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('drug_name', StringType(), True)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:44:58" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:44:58" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:44:58" - presc_run_data_transform - INFO - Transform - city_report() is started...
"20-Dec-24 16:44:58" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"20-Dec-24 16:44:58" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"20-Dec-24 16:44:59" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"20-Dec-24 16:44:59" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"20-Dec-24 16:44:59" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:45:10" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"20-Dec-24 16:45:10" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:45:10" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"20-Dec-24 16:45:10" - validations - INFO - The dataframe df_city_final schema is 
"20-Dec-24 16:45:10" - validations - INFO - 	StructField('city', StringType(), True)
"20-Dec-24 16:45:10" - validations - INFO - 	StructField('state_name', StringType(), True)
"20-Dec-24 16:45:10" - validations - INFO - 	StructField('county_name', StringType(), True)
"20-Dec-24 16:45:10" - validations - INFO - 	StructField('population', IntegerType(), True)
"20-Dec-24 16:45:10" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"20-Dec-24 16:45:10" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"20-Dec-24 16:45:10" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"20-Dec-24 16:45:10" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:45:10" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"20-Dec-24 16:45:10" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:45:13" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"20-Dec-24 16:45:13" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:45:13" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"20-Dec-24 16:45:13" - validations - INFO - The dataframe df_presc_final schema is 
"20-Dec-24 16:45:13" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:45:13" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:45:13" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:45:13" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:45:13" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:45:13" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:45:13" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:45:13" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:45:13" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:45:16" - root - ERROR - Error occurred in the main() method [PATH_ALREADY_EXISTS] Path hdfs://localhost:9000/datalake/staging_layer already exists. Set mode as "overwrite" to overwrite the existing path.
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 112, in main
    df_city_final.write.parquet("hdfs://localhost:9000/datalake/staging_layer/")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1721, in parquet
    self._jwrite.parquet(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [PATH_ALREADY_EXISTS] Path hdfs://localhost:9000/datalake/staging_layer already exists. Set mode as "overwrite" to overwrite the existing path.
"20-Dec-24 16:46:28" - root - INFO - run_presc_pipeline is started..
"20-Dec-24 16:46:28" - root - INFO - main() is started
"20-Dec-24 16:46:28" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"20-Dec-24 16:46:40" - create_objects - INFO - Spark object is created
"20-Dec-24 16:46:40" - root - INFO - Object created
"20-Dec-24 16:46:48" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 20))]
"20-Dec-24 16:46:48" - validations - INFO - Spark object is validated. Spark object is ready
"20-Dec-24 16:46:48" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:46:51" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:46:51" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:46:56" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:46:56" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"20-Dec-24 16:46:58" - validations - INFO - The dataframe count is 28338
"20-Dec-24 16:46:58" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:46:58" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"20-Dec-24 16:46:58" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:47:02" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:47:02" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:47:02" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"20-Dec-24 16:47:02" - validations - INFO - The dataframe count is 105
"20-Dec-24 16:47:02" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:47:02" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"20-Dec-24 16:47:02" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:47:03" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"20-Dec-24 16:47:03" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:47:03" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"20-Dec-24 16:47:03" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"20-Dec-24 16:47:03" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"20-Dec-24 16:47:03" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"20-Dec-24 16:47:03" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:47:04" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:47:04" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:47:04" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"20-Dec-24 16:47:04" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:47:05" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"20-Dec-24 16:47:05" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:47:05" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"20-Dec-24 16:47:05" - validations - INFO - The dataframe df_fact_sel schema is 
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('presc_city', StringType(), True)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('drug_name', StringType(), True)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:47:05" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:47:05" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:47:05" - presc_run_data_transform - INFO - Transform - city_report() is started...
"20-Dec-24 16:47:05" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"20-Dec-24 16:47:05" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"20-Dec-24 16:47:06" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"20-Dec-24 16:47:06" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"20-Dec-24 16:47:06" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:47:15" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"20-Dec-24 16:47:15" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:47:15" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"20-Dec-24 16:47:15" - validations - INFO - The dataframe df_city_final schema is 
"20-Dec-24 16:47:15" - validations - INFO - 	StructField('city', StringType(), True)
"20-Dec-24 16:47:15" - validations - INFO - 	StructField('state_name', StringType(), True)
"20-Dec-24 16:47:15" - validations - INFO - 	StructField('county_name', StringType(), True)
"20-Dec-24 16:47:15" - validations - INFO - 	StructField('population', IntegerType(), True)
"20-Dec-24 16:47:15" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"20-Dec-24 16:47:15" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"20-Dec-24 16:47:15" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"20-Dec-24 16:47:15" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:47:15" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"20-Dec-24 16:47:15" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:47:20" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"20-Dec-24 16:47:20" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:47:20" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"20-Dec-24 16:47:20" - validations - INFO - The dataframe df_presc_final schema is 
"20-Dec-24 16:47:20" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:47:20" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:47:20" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:47:20" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:47:20" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:47:20" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:47:20" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:47:20" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:47:20" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:47:37" - root - ERROR - Error occurred in the main() method An error occurred while calling o242.parquet.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to hdfs://localhost:9000/datalake/staging_layer/test.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:802)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to hdfs://localhost:9000/datalake/staging_layer/test.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 112, in main
    df_city_final.write.parquet("hdfs://localhost:9000/datalake/staging_layer/test/")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1721, in parquet
    self._jwrite.parquet(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o242.parquet.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.103 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to hdfs://localhost:9000/datalake/staging_layer/test.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:802)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to hdfs://localhost:9000/datalake/staging_layer/test.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"20-Dec-24 16:48:33" - root - INFO - run_presc_pipeline is started..
"20-Dec-24 16:48:33" - root - INFO - main() is started
"20-Dec-24 16:48:33" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"20-Dec-24 16:48:44" - create_objects - INFO - Spark object is created
"20-Dec-24 16:48:44" - root - INFO - Object created
"20-Dec-24 16:48:53" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2024, 12, 20))]
"20-Dec-24 16:48:53" - validations - INFO - Spark object is validated. Spark object is ready
"20-Dec-24 16:48:53" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:48:57" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:48:57" - presc_run_data_ingest - INFO - the load_files() function is started
"20-Dec-24 16:49:00" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"20-Dec-24 16:49:00" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"20-Dec-24 16:49:01" - validations - INFO - The dataframe count is 28338
"20-Dec-24 16:49:01" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:49:01" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"20-Dec-24 16:49:01" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:49:04" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:49:04" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:49:04" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"20-Dec-24 16:49:05" - validations - INFO - The dataframe count is 105
"20-Dec-24 16:49:05" - validations - INFO - The dataframe validation by df_count() is completed
"20-Dec-24 16:49:05" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"20-Dec-24 16:49:05" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:49:05" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"20-Dec-24 16:49:05" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:49:05" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"20-Dec-24 16:49:05" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"20-Dec-24 16:49:05" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"20-Dec-24 16:49:05" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"20-Dec-24 16:49:05" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:49:06" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"20-Dec-24 16:49:06" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:49:06" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"20-Dec-24 16:49:06" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:49:07" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"20-Dec-24 16:49:07" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:49:07" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"20-Dec-24 16:49:07" - validations - INFO - The dataframe df_fact_sel schema is 
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('presc_city', StringType(), True)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('drug_name', StringType(), True)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:49:07" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:49:07" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:49:07" - presc_run_data_transform - INFO - Transform - city_report() is started...
"20-Dec-24 16:49:07" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"20-Dec-24 16:49:07" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"20-Dec-24 16:49:07" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"20-Dec-24 16:49:07" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"20-Dec-24 16:49:07" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:49:11" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"20-Dec-24 16:49:11" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:49:11" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"20-Dec-24 16:49:11" - validations - INFO - The dataframe df_city_final schema is 
"20-Dec-24 16:49:11" - validations - INFO - 	StructField('city', StringType(), True)
"20-Dec-24 16:49:11" - validations - INFO - 	StructField('state_name', StringType(), True)
"20-Dec-24 16:49:11" - validations - INFO - 	StructField('county_name', StringType(), True)
"20-Dec-24 16:49:11" - validations - INFO - 	StructField('population', IntegerType(), True)
"20-Dec-24 16:49:11" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"20-Dec-24 16:49:11" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"20-Dec-24 16:49:11" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"20-Dec-24 16:49:11" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:49:11" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"20-Dec-24 16:49:11" - validations - INFO - The dataframe top 10 records are 
"20-Dec-24 16:49:12" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"20-Dec-24 16:49:12" - validations - INFO - The Dataframe validation by top10 records is completed
"20-Dec-24 16:49:12" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"20-Dec-24 16:49:12" - validations - INFO - The dataframe df_presc_final schema is 
"20-Dec-24 16:49:12" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"20-Dec-24 16:49:12" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"20-Dec-24 16:49:12" - validations - INFO - 	StructField('presc_state', StringType(), True)
"20-Dec-24 16:49:12" - validations - INFO - 	StructField('country_name', StringType(), False)
"20-Dec-24 16:49:12" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"20-Dec-24 16:49:12" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"20-Dec-24 16:49:12" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"20-Dec-24 16:49:12" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"20-Dec-24 16:49:12" - validations - INFO - The Dataframe schema validation is completed
"20-Dec-24 16:49:12" - root - INFO - presc_run_pipeline.py is completed
"02-Jan-25 10:13:26" - root - INFO - run_presc_pipeline is started..
"02-Jan-25 10:13:26" - root - INFO - main() is started
"02-Jan-25 10:13:26" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"02-Jan-25 10:14:58" - root - INFO - run_presc_pipeline is started..
"02-Jan-25 10:14:58" - root - INFO - main() is started
"02-Jan-25 10:14:58" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"02-Jan-25 10:15:06" - create_objects - INFO - Spark object is created
"02-Jan-25 10:15:06" - root - INFO - Object created
"02-Jan-25 10:15:15" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2025, 1, 2))]
"02-Jan-25 10:15:15" - validations - INFO - Spark object is validated. Spark object is ready
"02-Jan-25 10:15:15" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:15:19" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:15:19" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:15:22" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:15:22" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"02-Jan-25 10:15:23" - validations - INFO - The dataframe count is 28338
"02-Jan-25 10:15:23" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:15:23" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"02-Jan-25 10:15:23" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:15:26" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:15:26" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:15:26" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"02-Jan-25 10:15:27" - validations - INFO - The dataframe count is 105
"02-Jan-25 10:15:27" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:15:27" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"02-Jan-25 10:15:27" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:15:27" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"02-Jan-25 10:15:27" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:15:27" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"02-Jan-25 10:15:27" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"02-Jan-25 10:15:27" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"02-Jan-25 10:15:27" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"02-Jan-25 10:15:27" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:15:27" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:15:27" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:15:27" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"02-Jan-25 10:15:27" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:15:28" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"02-Jan-25 10:15:28" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:15:28" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"02-Jan-25 10:15:28" - validations - INFO - The dataframe df_fact_sel schema is 
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('presc_city', StringType(), True)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('drug_name', StringType(), True)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:15:28" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:15:28" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:15:28" - presc_run_data_transform - INFO - Transform - city_report() is started...
"02-Jan-25 10:15:28" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"02-Jan-25 10:15:28" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"02-Jan-25 10:15:28" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"02-Jan-25 10:15:28" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"02-Jan-25 10:15:28" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:15:32" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"02-Jan-25 10:15:32" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:15:32" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"02-Jan-25 10:15:32" - validations - INFO - The dataframe df_city_final schema is 
"02-Jan-25 10:15:32" - validations - INFO - 	StructField('city', StringType(), True)
"02-Jan-25 10:15:32" - validations - INFO - 	StructField('state_name', StringType(), True)
"02-Jan-25 10:15:32" - validations - INFO - 	StructField('county_name', StringType(), True)
"02-Jan-25 10:15:32" - validations - INFO - 	StructField('population', IntegerType(), True)
"02-Jan-25 10:15:32" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"02-Jan-25 10:15:32" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"02-Jan-25 10:15:32" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"02-Jan-25 10:15:32" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:15:32" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"02-Jan-25 10:15:32" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:15:33" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"02-Jan-25 10:15:33" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:15:33" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"02-Jan-25 10:15:33" - validations - INFO - The dataframe df_presc_final schema is 
"02-Jan-25 10:15:33" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:15:33" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:15:33" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:15:33" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:15:33" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:15:33" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:15:33" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:15:33" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:15:33" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:15:35" - root - ERROR - Error occurred in the main() method An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.104 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 113, in main
    df_city_final.write.csv("/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city/")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 35.0 failed 1 times, most recent failure: Lost task 0.0 in stage 35.0 (TID 23) (192.168.1.104 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"02-Jan-25 10:17:18" - root - INFO - run_presc_pipeline is started..
"02-Jan-25 10:17:18" - root - INFO - main() is started
"02-Jan-25 10:17:18" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"02-Jan-25 10:17:25" - create_objects - INFO - Spark object is created
"02-Jan-25 10:17:25" - root - INFO - Object created
"02-Jan-25 10:17:30" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2025, 1, 2))]
"02-Jan-25 10:17:30" - validations - INFO - Spark object is validated. Spark object is ready
"02-Jan-25 10:17:30" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:17:32" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:17:32" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:17:34" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:17:34" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"02-Jan-25 10:17:35" - validations - INFO - The dataframe count is 28338
"02-Jan-25 10:17:35" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:17:35" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"02-Jan-25 10:17:35" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:17:36" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:17:36" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:17:36" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"02-Jan-25 10:17:37" - validations - INFO - The dataframe count is 105
"02-Jan-25 10:17:37" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:17:37" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"02-Jan-25 10:17:37" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:17:37" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"02-Jan-25 10:17:37" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:17:37" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"02-Jan-25 10:17:37" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"02-Jan-25 10:17:37" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"02-Jan-25 10:17:37" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"02-Jan-25 10:17:37" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:17:37" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:17:37" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:17:37" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"02-Jan-25 10:17:37" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:17:39" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"02-Jan-25 10:17:39" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:17:39" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"02-Jan-25 10:17:39" - validations - INFO - The dataframe df_fact_sel schema is 
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('presc_city', StringType(), True)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('drug_name', StringType(), True)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:17:39" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:17:39" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:17:39" - presc_run_data_transform - INFO - Transform - city_report() is started...
"02-Jan-25 10:17:39" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"02-Jan-25 10:17:39" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"02-Jan-25 10:17:39" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"02-Jan-25 10:17:39" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"02-Jan-25 10:17:39" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:17:43" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"02-Jan-25 10:17:43" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:17:43" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"02-Jan-25 10:17:43" - validations - INFO - The dataframe df_city_final schema is 
"02-Jan-25 10:17:43" - validations - INFO - 	StructField('city', StringType(), True)
"02-Jan-25 10:17:43" - validations - INFO - 	StructField('state_name', StringType(), True)
"02-Jan-25 10:17:43" - validations - INFO - 	StructField('county_name', StringType(), True)
"02-Jan-25 10:17:43" - validations - INFO - 	StructField('population', IntegerType(), True)
"02-Jan-25 10:17:43" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"02-Jan-25 10:17:43" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"02-Jan-25 10:17:43" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"02-Jan-25 10:17:43" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:17:43" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"02-Jan-25 10:17:43" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:17:44" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"02-Jan-25 10:17:44" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:17:44" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"02-Jan-25 10:17:44" - validations - INFO - The dataframe df_presc_final schema is 
"02-Jan-25 10:17:44" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:17:44" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:17:44" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:17:44" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:17:44" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:17:44" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:17:44" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:17:44" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:17:44" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:17:49" - root - ERROR - Error occurred in the main() method [PATH_ALREADY_EXISTS] Path file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city already exists. Set mode as "overwrite" to overwrite the existing path.
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 113, in main
    df_city_final.write.csv("/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city/")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [PATH_ALREADY_EXISTS] Path file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city already exists. Set mode as "overwrite" to overwrite the existing path.
"02-Jan-25 10:18:45" - root - INFO - run_presc_pipeline is started..
"02-Jan-25 10:18:45" - root - INFO - main() is started
"02-Jan-25 10:18:45" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"02-Jan-25 10:18:58" - create_objects - INFO - Spark object is created
"02-Jan-25 10:18:58" - root - INFO - Object created
"02-Jan-25 10:19:08" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2025, 1, 2))]
"02-Jan-25 10:19:08" - validations - INFO - Spark object is validated. Spark object is ready
"02-Jan-25 10:19:08" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:19:11" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:19:11" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:19:14" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:19:14" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"02-Jan-25 10:19:16" - validations - INFO - The dataframe count is 28338
"02-Jan-25 10:19:16" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:19:16" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"02-Jan-25 10:19:16" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:19:18" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:19:18" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:19:18" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"02-Jan-25 10:19:19" - validations - INFO - The dataframe count is 105
"02-Jan-25 10:19:19" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:19:19" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"02-Jan-25 10:19:19" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:19:19" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"02-Jan-25 10:19:19" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:19:19" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"02-Jan-25 10:19:19" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"02-Jan-25 10:19:19" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"02-Jan-25 10:19:19" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"02-Jan-25 10:19:19" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:19:20" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:19:20" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:19:20" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"02-Jan-25 10:19:20" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:19:21" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"02-Jan-25 10:19:21" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:19:21" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"02-Jan-25 10:19:21" - validations - INFO - The dataframe df_fact_sel schema is 
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('presc_city', StringType(), True)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('drug_name', StringType(), True)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:19:21" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:19:21" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:19:21" - presc_run_data_transform - INFO - Transform - city_report() is started...
"02-Jan-25 10:19:21" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"02-Jan-25 10:19:21" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"02-Jan-25 10:19:21" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"02-Jan-25 10:19:21" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"02-Jan-25 10:19:21" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:19:27" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"02-Jan-25 10:19:27" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:19:27" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"02-Jan-25 10:19:27" - validations - INFO - The dataframe df_city_final schema is 
"02-Jan-25 10:19:27" - validations - INFO - 	StructField('city', StringType(), True)
"02-Jan-25 10:19:27" - validations - INFO - 	StructField('state_name', StringType(), True)
"02-Jan-25 10:19:27" - validations - INFO - 	StructField('county_name', StringType(), True)
"02-Jan-25 10:19:27" - validations - INFO - 	StructField('population', IntegerType(), True)
"02-Jan-25 10:19:27" - validations - INFO - 	StructField('zip_counts', IntegerType(), True)
"02-Jan-25 10:19:27" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"02-Jan-25 10:19:27" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"02-Jan-25 10:19:27" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:19:27" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"02-Jan-25 10:19:27" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:19:28" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"02-Jan-25 10:19:28" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:19:28" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"02-Jan-25 10:19:28" - validations - INFO - The dataframe df_presc_final schema is 
"02-Jan-25 10:19:28" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:19:28" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:19:28" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:19:28" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:19:28" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:19:28" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:19:28" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:19:28" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:19:28" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:19:37" - root - ERROR - Error occurred in the main() method An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 48.0 failed 1 times, most recent failure: Lost task 0.0 in stage 48.0 (TID 30) (192.168.1.104 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 113, in main
    df_city_final.write.csv("/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city/")
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o242.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 48.0 failed 1 times, most recent failure: Lost task 0.0 in stage 48.0 (TID 30) (192.168.1.104 executor driver): org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)
	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)
	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:418)
	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:390)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)
	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)
	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)
	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)
	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)
	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)
	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)
	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)
	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)
	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)
	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)
	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)
	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.spark.SparkException: [TASK_WRITE_FAILED] Task failed while writing rows to file:/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/final/city.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.taskFailedWhileWritingRowsError(QueryExecutionErrors.scala:775)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:420)
	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/udfs.py", line 6, in column_split_cnt
    return len(column.split(' '))
AttributeError: 'NoneType' object has no attribute 'split'

	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.handlePythonException(PythonRunner.scala:572)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:94)
	at org.apache.spark.sql.execution.python.BasePythonUDFRunner$$anon$1.read(PythonUDFRunner.scala:75)
	at org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:525)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:491)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.datasources.FileFormatDataWriter.writeWithIterator(FileFormatDataWriter.scala:91)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeTask$1(FileFormatWriter.scala:403)
	at org.apache.spark.util.Utils$.tryWithSafeFinallyAndFailureCallbacks(Utils.scala:1397)
	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:410)
	... 17 more

"02-Jan-25 10:25:11" - root - INFO - run_presc_pipeline is started..
"02-Jan-25 10:25:11" - root - INFO - main() is started
"02-Jan-25 10:25:11" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"02-Jan-25 10:25:19" - create_objects - INFO - Spark object is created
"02-Jan-25 10:25:19" - root - INFO - Object created
"02-Jan-25 10:25:23" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2025, 1, 2))]
"02-Jan-25 10:25:23" - validations - INFO - Spark object is validated. Spark object is ready
"02-Jan-25 10:25:23" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:25:25" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:25:25" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:25:27" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:25:27" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"02-Jan-25 10:25:28" - validations - INFO - The dataframe count is 28338
"02-Jan-25 10:25:28" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:25:28" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"02-Jan-25 10:25:28" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:25:29" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:25:29" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:25:29" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"02-Jan-25 10:25:30" - validations - INFO - The dataframe count is 105
"02-Jan-25 10:25:30" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:25:30" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"02-Jan-25 10:25:30" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:25:30" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"02-Jan-25 10:25:30" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:25:30" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"02-Jan-25 10:25:30" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"02-Jan-25 10:25:30" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"02-Jan-25 10:25:30" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"02-Jan-25 10:25:30" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:25:30" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:25:30" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:25:30" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"02-Jan-25 10:25:30" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:25:31" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"02-Jan-25 10:25:31" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:25:31" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"02-Jan-25 10:25:31" - validations - INFO - The dataframe df_fact_sel schema is 
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('presc_city', StringType(), True)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('drug_name', StringType(), True)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:25:31" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:25:31" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:25:31" - presc_run_data_transform - INFO - Transform - city_report() is started...
"02-Jan-25 10:25:31" - presc_run_data_transform - ERROR - Error in the method - city_report(). Please check the Stack Trace. [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `zip_counts` cannot be resolved. Did you mean one of the following? [`city`, `state_id`, `state_name`, `County_name`, `population`, `zips`].
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_transform.py", line 31, in city_report
    df_city_split = df_city_sel.withColumn("zip_counts", size(split(df_city_sel["zip_counts"], " ")))
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 3080, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `zip_counts` cannot be resolved. Did you mean one of the following? [`city`, `state_id`, `state_name`, `County_name`, `population`, `zips`].
"02-Jan-25 10:25:31" - root - ERROR - Error occurred in the main() method [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `zip_counts` cannot be resolved. Did you mean one of the following? [`city`, `state_id`, `state_name`, `County_name`, `population`, `zips`].
Traceback (most recent call last):
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/run_presc_pipeline.py", line 90, in main
    df_city_final = city_report(df_city_sel, df_fact_sel)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/src/main/python/bin/presc_run_data_transform.py", line 31, in city_report
    df_city_split = df_city_sel.withColumn("zip_counts", size(split(df_city_sel["zip_counts"], " ")))
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/sql/dataframe.py", line 3080, in __getitem__
    jc = self._jdf.apply(item)
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "/home/anmol/PycharmProjects/pipeline/pipeline/.venv/lib/python3.10/site-packages/pyspark/errors/exceptions/captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `zip_counts` cannot be resolved. Did you mean one of the following? [`city`, `state_id`, `state_name`, `County_name`, `population`, `zips`].
"02-Jan-25 10:27:14" - root - INFO - run_presc_pipeline is started..
"02-Jan-25 10:27:14" - root - INFO - main() is started
"02-Jan-25 10:27:14" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"02-Jan-25 10:27:18" - create_objects - INFO - Spark object is created
"02-Jan-25 10:27:18" - root - INFO - Object created
"02-Jan-25 10:27:22" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2025, 1, 2))]
"02-Jan-25 10:27:22" - validations - INFO - Spark object is validated. Spark object is ready
"02-Jan-25 10:27:22" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:27:23" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:27:23" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:27:26" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:27:26" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"02-Jan-25 10:27:27" - validations - INFO - The dataframe count is 28338
"02-Jan-25 10:27:27" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:27:27" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"02-Jan-25 10:27:27" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:27:28" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:27:28" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:27:28" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"02-Jan-25 10:27:28" - validations - INFO - The dataframe count is 105
"02-Jan-25 10:27:28" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:27:28" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"02-Jan-25 10:27:28" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:27:28" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"02-Jan-25 10:27:28" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:27:28" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"02-Jan-25 10:27:28" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"02-Jan-25 10:27:29" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"02-Jan-25 10:27:29" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"02-Jan-25 10:27:29" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:27:29" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:27:29" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:27:29" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"02-Jan-25 10:27:29" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:27:30" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"02-Jan-25 10:27:30" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:27:30" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"02-Jan-25 10:27:30" - validations - INFO - The dataframe df_fact_sel schema is 
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('presc_city', StringType(), True)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('drug_name', StringType(), True)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:27:30" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:27:30" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:27:30" - presc_run_data_transform - INFO - Transform - city_report() is started...
"02-Jan-25 10:27:30" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"02-Jan-25 10:27:30" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"02-Jan-25 10:27:30" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"02-Jan-25 10:27:30" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"02-Jan-25 10:27:30" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:27:31" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"02-Jan-25 10:27:31" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:27:31" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"02-Jan-25 10:27:31" - validations - INFO - The dataframe df_city_final schema is 
"02-Jan-25 10:27:31" - validations - INFO - 	StructField('city', StringType(), True)
"02-Jan-25 10:27:31" - validations - INFO - 	StructField('state_name', StringType(), True)
"02-Jan-25 10:27:31" - validations - INFO - 	StructField('county_name', StringType(), True)
"02-Jan-25 10:27:31" - validations - INFO - 	StructField('population', IntegerType(), True)
"02-Jan-25 10:27:31" - validations - INFO - 	StructField('zip_counts', IntegerType(), False)
"02-Jan-25 10:27:31" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"02-Jan-25 10:27:31" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"02-Jan-25 10:27:31" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:27:31" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"02-Jan-25 10:27:31" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:27:32" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"02-Jan-25 10:27:32" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:27:32" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"02-Jan-25 10:27:32" - validations - INFO - The dataframe df_presc_final schema is 
"02-Jan-25 10:27:32" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:27:32" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:27:32" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:27:32" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:27:32" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:27:32" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:27:32" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:27:32" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:27:32" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:27:37" - root - INFO - presc_run_pipeline.py is completed
"02-Jan-25 10:30:06" - root - INFO - run_presc_pipeline is started..
"02-Jan-25 10:30:06" - root - INFO - main() is started
"02-Jan-25 10:30:06" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"02-Jan-25 10:30:11" - create_objects - INFO - Spark object is created
"02-Jan-25 10:30:11" - root - INFO - Object created
"02-Jan-25 10:30:15" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2025, 1, 2))]
"02-Jan-25 10:30:15" - validations - INFO - Spark object is validated. Spark object is ready
"02-Jan-25 10:30:15" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:30:18" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:30:18" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:30:21" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:30:21" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"02-Jan-25 10:30:21" - validations - INFO - The dataframe count is 28338
"02-Jan-25 10:30:21" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:30:21" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"02-Jan-25 10:30:21" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:30:24" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:30:24" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:30:24" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"02-Jan-25 10:30:24" - validations - INFO - The dataframe count is 105
"02-Jan-25 10:30:24" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:30:24" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"02-Jan-25 10:30:24" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:30:24" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"02-Jan-25 10:30:24" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:30:24" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"02-Jan-25 10:30:24" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"02-Jan-25 10:30:24" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"02-Jan-25 10:30:24" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"02-Jan-25 10:30:24" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:30:25" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:30:25" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:30:25" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"02-Jan-25 10:30:25" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:30:25" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"02-Jan-25 10:30:25" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:30:25" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"02-Jan-25 10:30:25" - validations - INFO - The dataframe df_fact_sel schema is 
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('presc_city', StringType(), True)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('drug_name', StringType(), True)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:30:25" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:30:25" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:30:25" - presc_run_data_transform - INFO - Transform - city_report() is started...
"02-Jan-25 10:30:25" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"02-Jan-25 10:30:25" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"02-Jan-25 10:30:25" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"02-Jan-25 10:30:25" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"02-Jan-25 10:30:25" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:30:27" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"02-Jan-25 10:30:27" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:30:27" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"02-Jan-25 10:30:27" - validations - INFO - The dataframe df_city_final schema is 
"02-Jan-25 10:30:27" - validations - INFO - 	StructField('city', StringType(), True)
"02-Jan-25 10:30:27" - validations - INFO - 	StructField('state_name', StringType(), True)
"02-Jan-25 10:30:27" - validations - INFO - 	StructField('county_name', StringType(), True)
"02-Jan-25 10:30:27" - validations - INFO - 	StructField('population', IntegerType(), True)
"02-Jan-25 10:30:27" - validations - INFO - 	StructField('zip_counts', IntegerType(), False)
"02-Jan-25 10:30:27" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"02-Jan-25 10:30:27" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"02-Jan-25 10:30:27" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:30:27" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"02-Jan-25 10:30:27" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:30:28" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"02-Jan-25 10:30:28" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:30:28" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"02-Jan-25 10:30:28" - validations - INFO - The dataframe df_presc_final schema is 
"02-Jan-25 10:30:28" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:30:28" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:30:28" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:30:28" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:30:28" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:30:28" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:30:28" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:30:28" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:30:28" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:30:36" - root - INFO - presc_run_pipeline.py is completed
"02-Jan-25 10:48:23" - root - INFO - run_presc_pipeline is started..
"02-Jan-25 10:48:23" - root - INFO - main() is started
"02-Jan-25 10:48:23" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"02-Jan-25 10:48:36" - create_objects - INFO - Spark object is created
"02-Jan-25 10:48:36" - root - INFO - Object created
"02-Jan-25 10:48:40" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2025, 1, 2))]
"02-Jan-25 10:48:40" - validations - INFO - Spark object is validated. Spark object is ready
"02-Jan-25 10:48:40" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:48:42" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:48:42" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:48:44" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:48:44" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"02-Jan-25 10:48:46" - validations - INFO - The dataframe count is 28338
"02-Jan-25 10:48:46" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:48:46" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"02-Jan-25 10:48:46" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:48:48" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:48:48" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:48:48" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"02-Jan-25 10:48:49" - validations - INFO - The dataframe count is 105
"02-Jan-25 10:48:49" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:48:49" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"02-Jan-25 10:48:49" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:48:49" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"02-Jan-25 10:48:49" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:48:49" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"02-Jan-25 10:48:49" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"02-Jan-25 10:48:49" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"02-Jan-25 10:48:49" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"02-Jan-25 10:48:49" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:48:49" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:48:49" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:48:49" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"02-Jan-25 10:48:49" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:48:50" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"02-Jan-25 10:48:50" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:48:50" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"02-Jan-25 10:48:50" - validations - INFO - The dataframe df_fact_sel schema is 
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('presc_city', StringType(), True)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('drug_name', StringType(), True)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:48:50" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:48:50" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:48:50" - presc_run_data_transform - INFO - Transform - city_report() is started...
"02-Jan-25 10:48:50" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"02-Jan-25 10:48:50" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"02-Jan-25 10:48:50" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"02-Jan-25 10:48:50" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"02-Jan-25 10:48:50" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:48:53" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"02-Jan-25 10:48:53" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:48:53" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"02-Jan-25 10:48:53" - validations - INFO - The dataframe df_city_final schema is 
"02-Jan-25 10:48:53" - validations - INFO - 	StructField('city', StringType(), True)
"02-Jan-25 10:48:53" - validations - INFO - 	StructField('state_name', StringType(), True)
"02-Jan-25 10:48:53" - validations - INFO - 	StructField('county_name', StringType(), True)
"02-Jan-25 10:48:53" - validations - INFO - 	StructField('population', IntegerType(), True)
"02-Jan-25 10:48:53" - validations - INFO - 	StructField('zip_counts', IntegerType(), False)
"02-Jan-25 10:48:53" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"02-Jan-25 10:48:53" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"02-Jan-25 10:48:53" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:48:53" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"02-Jan-25 10:48:53" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:48:55" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"02-Jan-25 10:48:55" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:48:55" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"02-Jan-25 10:48:55" - validations - INFO - The dataframe df_presc_final schema is 
"02-Jan-25 10:48:55" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:48:55" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:48:55" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:48:55" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:48:55" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:48:55" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:48:55" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:48:55" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:48:55" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:49:02" - root - INFO - presc_run_pipeline.py is completed
"02-Jan-25 10:50:52" - root - INFO - run_presc_pipeline is started..
"02-Jan-25 10:50:52" - root - INFO - main() is started
"02-Jan-25 10:50:52" - create_objects - INFO - get_spark_objects is started. The 'TEST' envn is used
"02-Jan-25 10:50:58" - create_objects - INFO - Spark object is created
"02-Jan-25 10:50:58" - root - INFO - Object created
"02-Jan-25 10:51:02" - validations - INFO - Validate the spark object by printing current date [Row(current_date()=datetime.date(2025, 1, 2))]
"02-Jan-25 10:51:02" - validations - INFO - Spark object is validated. Spark object is ready
"02-Jan-25 10:51:02" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:51:03" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/us_cities_dimension.parquet is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:51:03" - presc_run_data_ingest - INFO - the load_files() function is started
"02-Jan-25 10:51:05" - presc_run_data_ingest - INFO - The input file hdfs://localhost:9000/datalake/raw_layer/USA_Presc_Medicare_Data_2021.csv is loaded in the datafram. the load_files() function is completed
"02-Jan-25 10:51:05" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_city
"02-Jan-25 10:51:06" - validations - INFO - The dataframe count is 28338
"02-Jan-25 10:51:06" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:51:06" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city
"02-Jan-25 10:51:06" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:51:07" - validations - INFO - 
 	        city   city_ascii state_id           state_name  county_fips          county_name     lat       lng  population  density            timezone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    New York     New York       NY             New York        36061             New York 40.6943  -73.9249    18713220    10715    America/New_York 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 Los Angeles  Los Angeles       CA           California         6037          Los Angeles 34.1139 -118.4068    12750807     3276 America/Los_Angeles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     Chicago      Chicago       IL             Illinois        17031                 Cook 41.8373  -87.6862     8604203     4574     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       Miami        Miami       FL              Florida        12086           Miami-Dade 25.7839  -80.2102     6445545     5019    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      Dallas       Dallas       TX                Texas        48113               Dallas 32.7936  -96.7662     5743938     1526     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
Philadelphia Philadelphia       PA         Pennsylvania        42101         Philadelphia 40.0077  -75.1339     5649300     4554    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     Houston      Houston       TX                Texas        48201               Harris 29.7863  -95.3889     5464251     1399     America/Chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     Atlanta      Atlanta       GA              Georgia        13121               Fulton 33.7627  -84.4224     5449398     1441    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  Washington   Washington       DC District of Columbia        11001 District of Columbia 38.9047  -77.0163     5379184     4457    America/New_York                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      Boston       Boston       MA        Massachusetts        25025              Suffolk 42.3188  -71.0846     4688346     5532    America/New_York                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:51:07" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:51:07" - validations - INFO - The dataframe validation by count df_count() is started for dataframe df_fact
"02-Jan-25 10:51:07" - validations - INFO - The dataframe count is 105
"02-Jan-25 10:51:07" - validations - INFO - The dataframe validation by df_count() is completed
"02-Jan-25 10:51:07" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact
"02-Jan-25 10:51:07" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:51:07" - validations - INFO - 
 	       npi nppes_provider_last_org_name nppes_provider_first_name nppes_provider_city nppes_provider_state specialty_description description_flag                     drug_name                   generic_name  bene_count  total_claim_count  total_30_day_fill_count  total_day_supply  total_drug_cost  bene_count_ge65 bene_count_ge65_suppress_flag  total_claim_count_ge65 ge65_suppress_flag  total_30_day_fill_count_ge65  total_day_supply_ge65  total_drug_cost_ge65 year_exp
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN                NaN                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1437118403                        QUINN                    RACHEL       FORT ATKINSON                   WI       Family Practice                S         METHENAMINE HIPPURATE          METHENAMINE HIPPURATE         NaN               99.0                     13.0               366          1159.13              NaN                             *                     NaN                  *                           NaN                    NaN                   NaN    = 2.0
1841297421                    SIFUENTES                     JORGE              BORGER                   TX      General Practice                S                      NYSTATIN                       NYSTATIN        19.0               40.0                     40.0               450           623.64              NaN                             #                    29.0               None                          29.0                  333.0                436.93    = 9.0
1770522567                  VAN DE BEEK                        M.        PHILADELPHIA                   PA       Family Practice                S                    CLONAZEPAM                     CLONAZEPAM         NaN               24.0                     32.0               960           118.55              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN   = 10.0
1497789556                       GRAHAM                       BOB           NASHVILLE                   TN     Internal Medicine                S                     CELECOXIB                      CELECOXIB         NaN               27.0                     41.0              1230          1221.21              NaN                             *                    27.0               None                          41.0                 1230.0               1221.21   = 12.0
1417913278                      JOHNSON                     DIANE             MINEOLA                   NY    Infectious Disease                S SULFAMETHOXAZOLE-TRIMETHOPRIM  SULFAMETHOXAZOLE/TRIMETHOPRIM         NaN               12.0                     12.0               360            77.57              0.0                          None                     0.0               None                           0.0                    0.0                  0.00   = 25.0
1437108628                     HOWERTON                     SHAWN            ROSEBORO                   NC       Family Practice                S                  KLOR-CON M20             POTASSIUM CHLORIDE         NaN               27.0                     31.0               930           309.60              NaN                             *                    27.0               None                          31.0                  930.0                309.60    = 3.0
1770779761                       KONTIR                   NATALEE          HOMER CITY                   PA       Family Practice                S             ZOLPIDEM TARTRATE              ZOLPIDEM TARTRATE         NaN               18.0                     26.0               780            40.76              NaN                             *                    18.0               None                          26.0                  780.0                 40.76    = 6.0
1518906262                     MATTIACE                   WILLIAM        WILLIAMSPORT                   PA       Family Practice                S                          None           ROSUVASTATIN CALCIUM        13.0               67.0                     91.0              2730         22141.56              NaN                             #                     NaN                  #                           NaN                    NaN                   NaN    = 6.0
1437312485                    GERRIETTS                  JENNIFER            JOHNSTON                   IA       Family Practice                S               INSULIN SYRINGE SYRING-NEEDL,DISP,INSUL,0.3 ML         NaN               17.0                     17.3               465           515.41              NaN                             *                    17.0               None                          17.3                  465.0                515.41   = 19.0
"02-Jan-25 10:51:07" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:51:07" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_city
"02-Jan-25 10:51:07" - presc_run_data_preprocessing - INFO - perform_data_clean() is started for df_fact
"02-Jan-25 10:51:08" - presc_run_data_preprocessing - INFO - perform_data_clean() is completed
"02-Jan-25 10:51:08" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_sel
"02-Jan-25 10:51:08" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:51:08" - validations - INFO - 
 	        city state_id           state_name          County_name  population                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                zips
    NEW YORK       NY             NEW YORK             NEW YORK    18713220 11229 11226 11225 11224 11222 11221 11220 11385 10169 10168 10167 10165 10162 10282 10280 10040 10044 11109 11104 11105 11379 11378 11377 11697 11694 11692 11693 11691 10271 10279 10278 10075 10302 10301 10452 11451 10475 10474 10471 10470 10473 10472 11228 11223 10103 11368 11369 11366 11367 11364 11365 11362 11363 11360 11361 10028 10029 10026 10027 10024 10025 10022 10023 10020 10021 11212 11213 11210 11211 11216 11217 11214 11215 11218 11219 10152 10153 10154 10307 10306 10305 11429 10310 10311 10312 10314 11432 11433 11430 11436 11434 11435 10453 10451 10457 10456 10455 10454 10459 10458 10128 10004 10005 10006 10007 10001 10002 10003 10009 11238 11239 11230 11231 11232 11233 11234 11235 11236 11237 11375 11374 11371 11370 11373 11372 10170 10171 10172 10173 10174 10177 11351 10039 10038 10035 10034 10037 10036 10031 10030 10033 10032 11201 11208 11203 11205 11204 11207 11206 11209 11411 11412 11413 11414 11415 11416 11417 11418 11419 11101 11102 11103 11106 11001 11005 11004 10065 10069 10199 10309 10308 10304 10303 11428 11421 11420 11423 11422 11425 11424 11427 11426 10466 10467 10464 10465 10462 10463 10460 10461 10468 10469 10119 10115 10112 10110 10111 11359 11358 11357 11356 11355 11354 10019 10018 10013 10012 10011 10010 10017 10016 10014 10008 10041 10043 10055 10060 10080 10081 10087 10090 10101 10102 10104 10105 10106 10107 10108 10109 10113 10114 10116 10117 10118 10120 10121 10122 10123 10124 10125 10126 10129 10130 10131 10132 10133 10138 10150 10151 10155 10156 10157 10158 10159 10160 10163 10164 10166 10175 10176 10178 10179 10185 10203 10211 10212 10213 10242 10249 10256 10258 10259 10260 10261 10265 10268 10269 10270 10272 10273 10274 10275 10276 10277 10281 10285 10286 10313 11120 11202 11241 11242 11243 11245 11247 11249 11251 11252 11256 11352 11380 11381 11386 11405 11431 11437 11439 11499 11690 11695
 LOS ANGELES       CA           CALIFORNIA          LOS ANGELES    12750807                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             90291 90293 90292 91316 91311 90037 90031 90008 90004 90005 90006 90007 90001 90002 90003 90710 90089 91344 91345 91340 91342 91343 90035 90034 90036 90033 90032 90039 90247 90248 91436 91371 91605 91604 91607 91601 91602 90402 90068 90069 90062 90063 90061 90066 90067 90064 90065 91326 91324 91325 90013 90012 90011 90010 90017 90016 90015 90014 90019 90090 90095 90094 91042 91040 91411 91352 91356 90041 90042 90043 90044 90045 90046 90047 90048 90049 90018 91423 90210 91303 91304 91306 91307 90079 90071 90077 90059 91608 91606 91331 91330 91335 90026 90027 90024 90025 90023 90020 90021 90028 90029 90272 90732 90731 90230 91406 91405 91403 91402 91401 91367 91364 90038 90057 90058 90744 90501 90502 90009 90030 90050 90051 90053 90054 90055 90060 90070 90072 90074 90075 90076 90078 90080 90081 90082 90083 90084 90086 90087 90088 90093 90099 90134 90189 90213 90294 90295 90296 90733 90734 90748 91041 91043 91305 91308 91309 91313 91327 91328 91329 91333 91334 91337 91346 91353 91357 91365 91392 91393 91394 91395 91396 91404 91407 91408 91409 91410 91412 91413 91416 91426 91470 91482 91495 91496 91499 91603 91609 91610 91611 91612 91614 91615 91616 91617 91618
     CHICAGO       IL             ILLINOIS                 COOK     8604203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             60018 60649 60641 60640 60643 60642 60645 60644 60647 60646 60616 60617 60614 60615 60612 60613 60610 60611 60618 60619 60827 60638 60639 60634 60636 60637 60630 60631 60632 60633 60605 60604 60607 60606 60601 60603 60602 60609 60608 60106 60661 60660 60659 60652 60653 60651 60656 60657 60654 60655 60623 60622 60621 60620 60626 60625 60624 60629 60628 60707 60499 60664 60666 60668 60669 60670 60673 60674 60675 60677 60678 60680 60681 60684 60685 60686 60687 60688 60689 60690 60694 60695 60696 60699
       MIAMI       FL              FLORIDA           MIAMI-DADE     6445545                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 33129 33125 33126 33127 33128 33149 33144 33145 33142 33139 33138 33137 33136 33135 33134 33133 33132 33131 33130 33150 33101 33109 33111 33151 33222 33231 33233 33238 33255 33299
      DALLAS       TX                TEXAS               DALLAS     5743938                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   75287 75098 75233 75254 75251 75252 75253 75032 75238 75232 75230 75231 75236 75237 75234 75235 75088 75087 75243 75246 75244 75249 75248 75051 75166 75210 75211 75212 75214 75215 75216 75217 75218 75219 75390 75182 75229 75228 75220 75223 75225 75224 75227 75226 75241 75240 75247 75270 75043 75207 75206 75205 75204 75203 75202 75201 75209 75208 75019 75221 75222 75242 75250 75260 75262 75263 75264 75266 75267 75277 75283 75284 75285 75301 75303 75312 75313 75315 75320 75336 75339 75342 75354 75355 75356 75357 75358 75359 75360 75367 75370 75371 75372 75373 75374 75376 75378 75379 75380 75382 75389 75392 75393 75394 75395 75397 75398
PHILADELPHIA       PA         PENNSYLVANIA         PHILADELPHIA     5649300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 19154 19151 19150 19153 19152 19102 19103 19106 19107 19104 19109 19128 19129 19120 19121 19122 19123 19124 19125 19126 19127 19112 19111 19115 19114 19116 19119 19118 19148 19149 19146 19147 19144 19145 19142 19143 19140 19141 19139 19138 19137 19136 19135 19134 19133 19132 19131 19130 19019 19092 19093 19099 19101 19105 19108 19110 19155 19160 19161 19162 19170 19171 19172 19173 19175 19176 19177 19178 19179 19181 19182 19183 19184 19185 19187 19188 19190 19191 19192 19193 19194 19195 19196 19197 19244 19255
     HOUSTON       TX                TEXAS               HARRIS     5464251                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       77069 77068 77061 77060 77063 77062 77065 77064 77067 77066 77036 77037 77034 77035 77032 77033 77030 77031 77038 77449 77489 77046 77045 77044 77040 77048 77201 77598 77018 77019 77015 77016 77017 77010 77011 77012 77013 77091 77093 77099 77053 77346 77345 77546 77547 77025 77024 77027 77026 77021 77020 77023 77022 77029 77028 77094 77096 77090 77098 77078 77079 77072 77073 77070 77071 77076 77077 77074 77075 77407 77047 77043 77041 77336 77339 77338 77003 77002 77007 77006 77005 77004 77009 77008 77571 77450 77082 77089 77088 77083 77081 77080 77087 77086 77085 77084 77092 77042 77054 77055 77056 77057 77058 77059 77396 77051 77506 77504 77001 77052 77202 77203 77204 77205 77206 77207 77208 77209 77210 77212 77213 77215 77216 77217 77218 77219 77220 77221 77222 77223 77225 77226 77227 77228 77229 77230 77231 77233 77234 77235 77236 77237 77241 77242 77243 77244 77245 77248 77249 77251 77252 77253 77254 77255 77256 77257 77259 77261 77262 77263 77266 77269 77270 77271 77272 77273 77274 77275 77282 77284 77287 77288 77289 77291 77292 77293 77297 77299 77315 77325 77411
     ATLANTA       GA              GEORGIA               FULTON     5449398                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           30334 30331 30332 30309 30308 30305 30307 30303 30354 30327 30322 30326 30324 30319 30342 30306 30318 30316 30317 30314 30315 30312 30313 30310 30311 30363 30301 30302 30304 30321 30325 30333 30343 30348 30353 30355 30357 30361 30368 30369 30370 30371 30375 30377 30392 30394 30398 31106 31107 31126 31139 31141 31193 31195 31196
  WASHINGTON       DC DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184                                                                                                                                                 20010 20011 20012 20015 20228 20520 20307 20418 20319 20024 20510 20593 20020 20427 20540 20240 20245 20204 20202 20390 20006 20005 20004 20003 20002 20009 20008 20535 20317 20405 20057 20052 20053 20017 20018 20565 20566 20560 20260 20064 20551 20553 20019 20230 20373 20007 20032 20036 20037 20506 20001 20045 20016 20013 20022 20026 20027 20029 20030 20033 20035 20038 20039 20040 20042 20043 20044 20047 20049 20050 20055 20056 20058 20059 20060 20061 20062 20063 20065 20066 20067 20068 20069 20070 20071 20073 20074 20075 20076 20077 20078 20080 20081 20082 20090 20091 20201 20203 20206 20207 20208 20210 20211 20212 20213 20214 20215 20216 20217 20218 20219 20220 20221 20222 20223 20224 20226 20227 20229 20232 20233 20235 20237 20238 20239 20241 20242 20244 20250 20251 20252 20254 20261 20262 20265 20266 20268 20270 20277 20289 20299 20301 20303 20306 20310 20314 20318 20330 20340 20350 20355 20370 20372 20374 20375 20376 20380 20388 20389 20391 20392 20393 20394 20395 20398 20401 20402 20403 20404 20406 20407 20408 20410 20411 20412 20413 20414 20415 20416 20417 20419 20420 20421 20422 20423 20424 20425 20426 20428 20429 20431 20433 20434 20435 20436 20437 20439 20440 20441 20442 20444 20447 20451 20453 20456 20460 20463 20468 20469 20470 20472 20500 20501 20502 20503 20504 20505 20507 20508 20509 20511 20515 20521 20522 20523 20524 20525 20526 20527 20528 20529 20530 20531 20533 20534 20536 20537 20538 20539 20541 20542 20543 20544 20546 20547 20548 20549 20552 20554 20555 20557 20559 20570 20571 20572 20573 20575 20576 20577 20578 20579 20580 20581 20585 20586 20590 20591 20594 20597 20599 56901 56902 56904 56908 56915 56920 56933 56935 56944 56945 56950 56965 56967 56972 56998 56999
      BOSTON       MA        MASSACHUSETTS              SUFFOLK     4688346                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   02120 02121 02122 02124 02125 02126 02127 02128 02129 02467 02210 02215 02119 02118 02111 02110 02113 02115 02114 02116 02199 02134 02136 02135 02132 02131 02130 02203 02163 02152 02108 02109 02112 02117 02123 02133 02137 02196 02201 02205 02206 02211 02212 02217 02222 02241 02283 02284 02293 02297 02298
"02-Jan-25 10:51:08" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:51:08" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_fact_sel
"02-Jan-25 10:51:08" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:51:09" - validations - INFO - 
 	  presc_id     presc_city presc_state       presc_spclt  year_exp           drug_name  trx_cnt  total_day_supply  total_drug_cost country_name   presc_fullname
1013960756 CATHEDRAL CITY          CA Internal Medicine         7           LACTULOSE       49              1458          1392.42          USA       GARY HUANG
1023025798    PORT JERVIS          NY Internal Medicine         6       MEMANTINE HCL       42               959          1632.96          USA       GOPAL SHAH
1033120787    LOS ANGELES          CA          Podiatry        28              LYRICA       15               540          6541.32          USA  CHARLES ANANIAN
1033211784         MALONE          NY Internal Medicine        23 PANTOPRAZOLE SODIUM       16               481           119.27          USA PRABHNA KANDIYIL
1033436191  MUSCLE SHOALS          AL Internal Medicine        23          LISINOPRIL      661             37465          4144.77          USA        ROY BARCO
1043238363      ST GEORGE          UT   Family Practice         5           ESTRADIOL       58              2640           422.78          USA    STEPHEN CLARK
1043335219     GREENVILLE          SC       Dermatology        26      HYDROCORTISONE       35               589           272.48          USA  MARSHALL SHULER
1053315424         CANTON          SD   Family Practice        27              LANTUS       12               360          3044.16          USA  MARGARET DEVICK
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
1063790400    WORTHINGTON          MN   Family Practice        17  POTASSIUM CHLORIDE      100               769           612.50          USA      ALBOURY SOW
"02-Jan-25 10:51:09" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:51:09" - validations - INFO - the Dataframe schema validation for dataframe df_fact_sel
"02-Jan-25 10:51:09" - validations - INFO - The dataframe df_fact_sel schema is 
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('presc_city', StringType(), True)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('presc_spclt', StringType(), True)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('drug_name', StringType(), True)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:51:09" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:51:09" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:51:09" - presc_run_data_transform - INFO - Transform - city_report() is started...
"02-Jan-25 10:51:09" - presc_run_data_transform - INFO - Transform - city_report() is completed...
"02-Jan-25 10:51:09" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is started...
"02-Jan-25 10:51:09" - presc_run_data_transform - INFO - Transform - top_5_Prescribers() is completed...
"02-Jan-25 10:51:09" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_city_final
"02-Jan-25 10:51:09" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:51:11" - validations - INFO - 
 	        city           state_name          county_name  population  zip_counts  trx_counts  presc_counts
 LOS ANGELES           CALIFORNIA          LOS ANGELES    12750807         196          26             2
PHILADELPHIA         PENNSYLVANIA         PHILADELPHIA     5649300          86          24             1
  WASHINGTON DISTRICT OF COLUMBIA DISTRICT OF COLUMBIA     5379184         286          35             1
     PHOENIX              ARIZONA             MARICOPA     4219697          82          58             2
      DENVER             COLORADO               DENVER     2876625          54          59             1
    BROOKLYN             NEW YORK                KINGS     2559903          37         238             3
  SACRAMENTO           CALIFORNIA           SACRAMENTO     1898019          86          23             1
    SAN JOSE           CALIFORNIA          SANTA CLARA     1798103          58          18             1
  PITTSBURGH         PENNSYLVANIA            ALLEGHENY     1703266          52          11             1
       BRONX             NEW YORK                BRONX     1418207          25          14             1
"02-Jan-25 10:51:11" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:51:11" - validations - INFO - the Dataframe schema validation for dataframe df_city_final
"02-Jan-25 10:51:11" - validations - INFO - The dataframe df_city_final schema is 
"02-Jan-25 10:51:11" - validations - INFO - 	StructField('city', StringType(), True)
"02-Jan-25 10:51:11" - validations - INFO - 	StructField('state_name', StringType(), True)
"02-Jan-25 10:51:11" - validations - INFO - 	StructField('county_name', StringType(), True)
"02-Jan-25 10:51:11" - validations - INFO - 	StructField('population', IntegerType(), True)
"02-Jan-25 10:51:11" - validations - INFO - 	StructField('zip_counts', IntegerType(), False)
"02-Jan-25 10:51:11" - validations - INFO - 	StructField('trx_counts', LongType(), True)
"02-Jan-25 10:51:11" - validations - INFO - 	StructField('presc_counts', LongType(), False)
"02-Jan-25 10:51:11" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:51:11" - validations - INFO - The dataframe validation by the top 10 records is started for dataframe df_presc_final
"02-Jan-25 10:51:11" - validations - INFO - The dataframe top 10 records are 
"02-Jan-25 10:51:12" - validations - INFO - 
 	  presc_id   presc_fullname presc_state country_name  year_exp  trx_cnt  total_day_supply  total_drug_cost
1033436191        ROY BARCO          AL          USA        23      661             37465          4144.77
1346399607        NATHAN HO          CA          USA        28       21               374           682.03
1619073848    SHINGSAN CHOU          CA          USA        20       18               900           893.07
1992766604     JOSE CACERES          CA          USA        26       16               205          4152.07
1033120787  CHARLES ANANIAN          CA          USA        28       15               540          6541.32
1588696223         TU HOANG          CA          USA        21       14               820           127.96
1962701417  MADISON PADDOCK          DC          USA        22       35              1100           359.42
1396968145     BEVERLY CASH          FL          USA        21       12               360            78.08
1376579706         TZE CHAN          IA          USA        28       16               480           402.17
1356352116 SUSANNAH FRIEMEL          IA          USA        30       11               330           200.23
"02-Jan-25 10:51:12" - validations - INFO - The Dataframe validation by top10 records is completed
"02-Jan-25 10:51:12" - validations - INFO - the Dataframe schema validation for dataframe df_presc_final
"02-Jan-25 10:51:12" - validations - INFO - The dataframe df_presc_final schema is 
"02-Jan-25 10:51:12" - validations - INFO - 	StructField('presc_id', IntegerType(), True)
"02-Jan-25 10:51:12" - validations - INFO - 	StructField('presc_fullname', StringType(), False)
"02-Jan-25 10:51:12" - validations - INFO - 	StructField('presc_state', StringType(), True)
"02-Jan-25 10:51:12" - validations - INFO - 	StructField('country_name', StringType(), False)
"02-Jan-25 10:51:12" - validations - INFO - 	StructField('year_exp', IntegerType(), True)
"02-Jan-25 10:51:12" - validations - INFO - 	StructField('trx_cnt', IntegerType(), True)
"02-Jan-25 10:51:12" - validations - INFO - 	StructField('total_day_supply', IntegerType(), True)
"02-Jan-25 10:51:12" - validations - INFO - 	StructField('total_drug_cost', DoubleType(), True)
"02-Jan-25 10:51:12" - validations - INFO - The Dataframe schema validation is completed
"02-Jan-25 10:51:17" - root - INFO - presc_run_pipeline.py is completed
